      SUBROUTINE FB.PROCESS.CALC(VIN,VOUT,CLIENT.ID,CLIENT.REC)
***********************************************************************
* Program name :  FB.PROCESS.CALC
* Author       :  UNKNOWN
* Date written :  UNKNOWN
* Library      :  FBBP
$* COPYRIGHT (C) 2016 - AFS LOGISTICS LLC - ALL RIGHTS RESERVED.
*
* PERFORM STANDARD FB PROCESSING CALCULATION
* Last updated by afs (AFSLOGISTICS\gbino) at 11:06:33 on 02/09/2018.
*
* Mod nn  mm/dd/yy, init, req #, description
* Start modification history
* 022505 - JMK01 - REMOVE STC POSTAGE CALC FOR LOGISTICS CLIENTS
* 030705 - JMK02 - RESOLVE MINIMUM FEES FOR NO PER BILLS FEES
* 040405 - JMK03 - CALCULATE PER BILL POSTAGE BASED ON NEW FIELD (201)
* 051905 - JMK04 - ADD LOGISTICS FLAT FEES (01148)
* 110705 - JMK05 - ADD FLAT FEE ALLOCATIONS
* 080306 - JMK06 - REMOVE GARDNER GLASS (01003) FROM DIVISIONAL FEE CALC
* 080806 - JMK07 - ADD SEPARATE.DIVISIONS TO HANDLE GARDNER GLASS (01003) FEES
* 082106 - JMK08 - ADD DYNACOM INTL (01470) TO DIVISIONAL FEE CALC
* 110706 - JMK09 - DO NOT SHOW WEEKLY FEES ON DIVISION SHEETS FOR UNITED ENGINES (01486)
* 112906 - JMK10 - DO NOT SHOW WEEKLY FEES ON DIVISION SHEETS FOR LAB (01517)
* 050807 - JMK11 - C200704250003  /   /  Leisure Arts Divisions
* 051007 - JMK12 - C200705070009 5/13/07 /  Postage Increase
* 061207 - JMK13 - C200706050004 / 6/11/07 / weekly fees split by division (01536)
* 121207 - NPR01 - Removed divisional summary of charges for Logistics Flat-Fee
* 013008 - NPR02 - Added back divisional summary of charges for Logistics Flat-Fee CL# 01128 & 01499
* 022708 - JMK14 - C080628 - Flat fee per bill on specified carriers TL Logistics
* 043008 - JMK15 - C080876 - Postage change effective 5/12/08
* 051908 - JMK16 - T081351 - 01635 - Manar ; weekly fee not showing on report
* 061708 - JMK17 - C081412 - Additional "Optional" page for Summary of Charges
* 072308 - JMK18 - FedEx per bill fee adjustments for 01148
* 020309 - JMK19 - Amarillo Gear Account #01584 - Division 1 billing
* 022309 - JMK20 - T090266 - Processing Fees not on 01671 Image Projections West
* 032509 - JMK21 - C090367 - Postage increase effective May 11, 2009
* 052909 - JMK22 - Correct Divisional Billing for Vermeer
* 071609 - JMK23 - C090919 - Vermeer Equipment of Tx 01592 ; split weekly processing fee & postage across branches w/ shipments
* 071609 - JMK24 - REVERSE C090919
* 080509 - JMK25 - Setup Divisional Billing for Regal Plastics 00666
* 081409 - JMK26 - C091043 - Processing fees ; need to split up by division for #1763 Pipeline Seal
* 100509 - JMK27 - C091213 - Bell Micro processing adjustment
* 010410 - JMK28 - T091549 - Vermeer equipment /weekly fee split
* 031110 - JMK29 - C100229 - Amarillo Gear: change the hard-coded $40 processing fee to be pro-rated based on the number of days processed.
* 041310 - JMK30 - C100294 - Regions turned on for Rawson 01830 and split fees
* 050510 - JMK31 - C100422 - Weekly Processing fee should be on branch 1 reports only 00937 American Maplan
* 060210 - JMK32 - T100481 - Weekly fee / postage are under-calculated
* 111810 - JMK33 - SETUP 01939 TO HAVE PER DIVISION FEE AND ROLL UP TO CORPORATE PAGE
* 010611 - JMK34 - C110016 - Bray 01499 - Processing and postage for all Divisions should be on Div 1
* 032411 - NPR03 - T110051 - Split weekly processing fee & postage across branches w/ shipments for Thorco 01035 - Myra indicated that this
*                            should be the default way.
* 071811 - JMK35 - T110808 - Weekly fee not showing on SOC for Wabtec
* 081611 - JMK36 - T110988 - Bach Simpson processing fee discrepancy
* 102511 - JMK37 - HelpDesk#79 - Wabtec SOC is not showing process and handling fee from Procomm Printout.
* 022812 - JMK38 - HelpDesk#1618 - Pay by Division for Client 01682
* 031512 - JMK39 - HelpDesk#2514 - Pay by Division for Client 01949
* 070912 - JMK40 - HelpDesk#3113 - Client 02084 Bag Corp Processing and postage for all Divisions should be on Div 4
* 090612 - JMK41 - HelpDesk#3673 - 30036 Shepherd Distribution
* 110513 - JMK42 - SysAid#7566 - Adding 2 regions to client 01401
* 030414 - DRF01 - SysAid# 8678 Dr Shrink - Division 1 billing
* 033114 - DRF02 - SysAid# 9201 Speedling (01436) - Divisional billing
* 033114 - DRF03 - SysAid# 7998 Schafer Driveline (02172) - Divisional billing
* 070914 - DRF04 - SysAid# 10031 01384 - Divisional billing
* 081114 - JMK43 - SysAid#11333 - summary of charges doesnt reflect charge pages
* 011515 - DRF05 - SysAid 13365 - Remove divisional break down and just
*                  charge 40.00 weekly fee for corp.
* 062615 - DRF06 - SysAid 18023 - Setup region SYNRG and division 02020
*                  to get all of the week fees
* 082615 - DRF07 - SysAid 19532 - Setup region 1 and division 00001
*                  to get all of the week fees
* 083FORT15 - DRF08 - SysAid 19625 - Setup region 1 and division 00001
*                  to get all of the week fees
* 081916 - DRF09 - SysAid 26474 - Weekly Processing fee should be on branch 1 reports only 01672 Brainerd Chemical Complany
* 092016 - DRF10 - SysAid 27110 - Setup division 00001 to get all of the week fees
* 032417 - DRF11 - SysAid 31302 - changed to charge division 00015 instead
*                  of division 00004 for client 02084 Bag Corp
* 040417 - DRF12 - SysAid 31040 setup region SHEP and division 00001 to be charged the weekly fees
* 060817 - DRF13 - SysAid 33248 Do not show the Pulse BI for division
*                  unless divisional calculatiion is on
* 110217 - DRF14 - Ticket 8013 - Pay by division for client 05234
* 020918 - GRB01 - ME 10274 - Setup region 1 and division 00001 to get all of the week feesPay by division for client 05702
* 062718 - DRF15 - Ticket 13369 - Do not show the weekly fee on the divisional report
* 080218 - DRF16 - Ticket REP-28 Setup region VOLEX and division 00001 to get all of the week fees. Pay by division for client 30041.
* 092718 - DRF17 - Ticket ACCU-97 calculate a minimum logistics fee for 
*                  client 01700 Notions
* 100218 - DRF18 - Ticket ACCU-122 Setup regions for 01485 Feintool CIN
* 100518 - DRF19 - Ticket ACCU-155 Setup divisions for 01256 Rubber Product so that division 00001 get all of the weekly charges.
* 071019 - DRF20 - Ticket ACCU-397 - Added Analytics fee calculation
* 081519 - DRF21 - Ticket ACCU-460 - Setup divisions for 06024 Basler Electric so that division 00001 gets all of the weekly charges
* 010220 - DRF22 - ACCU-729 - Do not included duplicate bills in the per bill fee for client 05171 Acme Brick
* 010622 - DRF24 - ACCU-1472 - Change Airgas fee to be .475 instead of .500
* 101022 - DRF25 - ACCU-1920 - Change Airgas fee to be .450 instead of .475
* 011623 - DRF26 - ACCU-2018 - Change Airgas fee to be 8.55 and 0.50 
*                  instead of 7.60 and 0.45
* 060523 - DRF27 - ACCU-2220 - Change Airgas fee to be 9.10 and 0.50 
*                  instead of 8.55 and 0.50
* 071023 - DRF28 - ACCU-2312 Change per bill fee from 9.10 to 9.125 and
*                  0.500 to 0.525
* 012924 - DRF29 - ACCU-2563 Change per bill fee from 9.125 to 9.43 and
*                  0.525 to 0.570
* 021424 - DRF30 - ACCU-2571 Special pricing for INTL and Non INTL for 
*                  clients 06902, 06903, 06904, 06905, 06906 AND 06908
* 040324 - NKH01 - ACCU-2634 Modified per bill fee from 7.95 to 8.95 for client 5171
* End modification history
****************************************************************************
      CALL GET.USER.NEW(USER,CH.NUM)
      UPL.VIN = 'FBBP' ; UPL.VIN<2> = 'FB.PROCESS.CALC' ; UPL.VOUT = ''          ; * NPR_UPL 04/23/2010
      UPL.VIN<3> = USER
      UPL.VIN<4> = CH.NUM
      CALL UPD.PROGRAM.LOG(UPL.VIN,UPL.VOUT)       ; * NPR_UPL 04/23/2010
*
* DEFINE INTERNAL VARIABLES
*
      FB.OZ=.6333
*
* SET ALL CALCULATED FEES TO 0
*
      POSTAGE.FEE=0
      PSTG.FEE=0
      REJECT.PSTG.FEE=0
      STC.PSTG.FEE=0
      PRE.AUDIT.FEE=0
      PROCESS.FEE=0
      PPR.BILLS.FEE=0
      EDI.LTL.FEE=0
      EDI.PARCEL.FEE=0
      EDI.FED.FEE=0
      DUP.FEE=0
      REJECT.FEE=0
      PR.PROCESS.FEE=0
      UPS.PROCESS.FEE=0
      UPS.TRACK.FEE=0
      REJECT.CNT=0
      CURR.REJ.CNT=0
      PPR.BILLS.CNT=0
*
* DEFINE INCOMING ARGUMENTS AND ASSOCIATIONS
*
      BEG.DATE=VIN<1>
      END.DATE=VIN<2>
      PROC.DATE=VIN<3>
      DAYS=VIN<4>
      BILLS.CNT=VIN<5>
      CARRIER.CNT=VIN<6>
      DUP.CNT=VIN<7>
      IF CLIENT.ID='05171' THEN DUP.CNT=0    ; * DRF22
      IF CLIENT.ID='06795' THEN DUP.CNT=0
      IF CLIENT.REC<316>=1 THEN DUP.CNT=0
      EDI.CNT.ARRAY=VIN<8>
      FED.EDI.CNT=DCOUNT(EDI.CNT.ARRAY<1>,@VM)
      EDI.LTL.CNT=VIN<9>
      EDI.MD.FDX.GRD.CNT=VIN<10>
      EDI.NON.FDX.AIR.CNT=VIN<11>
      EDI.PARCEL.CNT=VIN<12>
      HOLD.CNT=VIN<13>
      NEVERPAY.CNT=VIN<14>
      PR.BILLS.CNT=VIN<15>
      RELEASED.CNT=VIN<16>
      UPS.BILLS.CNT=VIN<17>
      UPS.TRACK.CNT=VIN<18>
      DIV.CODE=VIN<19>
IF USER='DAVID' THEN CALL ELINE('PRESS BREAK DIV.CODE VIN<19>')
      DIV.LIST=''                        ; * JMK11
      MULTI.PROC.DATE=0
      CHECK.PROC.DATE.ARRAY=''
      NVAL=DCOUNT(DIV.CODE,@VM)          ; * JMK11
      FOR VAL=1 TO NVAL                  ; * JMK11
         DIV.LIST<1,VAL>=DIV.CODE<1,VAL>[1,5]      ; * JMK11 - THIS CONTAINS THE DIV AND PROCESS DATE
         CHECK.PROC.DATE=DIV.CODE<1,VAL>[6,999]
         LOCATE CHECK.PROC.DATE IN CHECK.PROC.DATE.ARRAY<1> BY 'AR' SETTING TEMP.POS ELSE
            INS CHECK.PROC.DATE BEFORE CHECK.PROC.DATE.ARRAY<1,TEMP.POS>
         END
      NEXT VAL                           ; * JMK11
      NUM.PROC.DATE=DCOUNT(CHECK.PROC.DATE.ARRAY,@VM)
      IF NUM.PROC.DATE GT 1 THEN MULTI.PROC.DATE=1
      SEP.DIV=VIN<20>                    ; * JMK07
      USER=VIN<21>                       ; * JMK11
      DIV.LIST=''                        ; * JMK16
      DIV.LIST<1>=VIN<22>                ; * JMK16
      DIV.LIST<2>=VIN<23>                ; * JMK16
      REJECT.CNT=NEVERPAY.CNT+HOLD.CNT+RELEASED.CNT
      CURR.REJ.CNT=NEVERPAY.CNT+HOLD.CNT
      PPR.BILLS.CNT=BILLS.CNT-EDI.LTL.CNT-EDI.PARCEL.CNT
      LOGISTICS=(CLIENT.REC<93>="Y")     ; * JMK01
      PB.PSTG=CLIENT.REC<201>            ; * JMK03
      DIV.REG=VIN<24>                    ; * JMK30 D-DIV, R-REG
      REG.DIV.ARRAY=''                   ; * JMK37
      REG.DIV.ARRAY<1>=VIN<25>           ; * JMK37
      REG.DIV.ARRAY<2>=VIN<26>           ; * JMK37
      REG.DIV.ARRAY<3>=VIN<27>           ; * JMK37
      REG.DIV.ARRAY<4>=VIN<28>           ; * JMK37
      REG.DIV.ARRAY<5>=VIN<29>           ; * JMK37
      NON.VOUCHER.CARRIER.CNT=VIN<30>
      C.CONS.COM=VIN<31>    
      LTL.COUNT=VIN<32>    ; * DRF23
      NON.LTL.COUNT=VIN<33>  ; * DRF23 
      INTL.COUNT=VIN<34>    ; * DRF30
      NON.INTL.COUNT=VIN<35>  ; * DRF30 
IF USER='DAVID' THEN CALL ELINE('PRESS BREAK INTL BILLS')
      IF CLIENT.ID='01499' THEN          ; * JMK34
         IF SEP.DIV+0=0 THEN             ; * JMK34
            @USER2=CARRIER.CNT           ; * JMK34
         END ELSE                        ; * JMK34
            IF DIV.CODE[1,5]='00001' THEN          ; * JMK34
               CARRIER.CNT=@USER2        ; * JMK34
            END                          ; * JMK34
         END                             ; * JMK34
      END                                ; * JMK34
      IF CLIENT.ID='01682' THEN          ; * JMK38
         IF SEP.DIV+0=0 THEN             ; * JMK38
            @USER2=CARRIER.CNT           ; * JMK38
         END ELSE                        ; * JMK38
            IF DIV.CODE[1,5]='00001' THEN          ; * JMK38
               CARRIER.CNT=@USER2        ; * JMK38
            END                          ; * JMK38
         END                             ; * JMK38
      END                                ; * JMK38
      IF CLIENT.ID='02084' THEN          ; * JMK40
         IF SEP.DIV+0=0 THEN             ; * JMK40
            @USER2=CARRIER.CNT           ; * JMK40
         END ELSE                        ; * JMK40
            IF DIV.CODE[1,5]='00015' THEN          ; * JMK40 ; * DRF11
               CARRIER.CNT=@USER2        ; * JMK40
            END                          ; * JMK40
         END                             ; * JMK40
      END                                ; * JMK40

      BEGIN CASE                         ; * JMK12
         CASE PROC.DATE>=ICONV('05-11-09','D')     ; * JMK21
            USPS.PSTG.RATE=44            ; * JMK21
            USPS.PRCL.RATE=122           ; * JMK21
         CASE PROC.DATE>=ICONV('05-12-08','D')     ; * JMK15
            USPS.PSTG.RATE=42            ; * JMK15
            USPS.PRCL.RATE=62            ; * JMK15
         CASE PROC.DATE>=ICONV('05-14-07','D')     ; * JMK12
            USPS.PSTG.RATE=41            ; * JMK12
            USPS.PRCL.RATE=60            ; * JMK12
         CASE PROC.DATE>=ICONV('01-08-06','D')     ; * JMK12
            USPS.PSTG.RATE=39            ; * JMK12
            USPS.PRCL.RATE=39            ; * JMK12
         CASE PROC.DATE>=ICONV('05-05-00','D')     ; * JMK12
            USPS.PSTG.RATE=37            ; * JMK12
            USPS.PRCL.RATE=37            ; * JMK12
         CASE 1                          ; * JMK12
            USPS.PSTG.RATE=34            ; * JMK12
            USPS.PRCL.RATE=34            ; * JMK12
      END CASE                           ; * JMK12
      BUILD.DTL=(CLIENT.REC<233>='Y')    ; * JMK17
      IF USER='NO-MKERBOW' THEN BUILD.DTL=1

      DTL.ARRAY=''                       ; * JMK17
      PSTG.DTL=''                        ; * JMK17
      REJECT.PSTG.DTL=''                 ; * JMK17
      STC.PSTG.DTL=''                    ; * JMK17
      PRE.AUDIT.DTL=''                   ; * JMK17
      PPR.BILLS.DTL=''                   ; * JMK17
      EDI.LTL.DTL=''                     ; * JMK17
      EDI.PARCEL.DTL=''                  ; * JMK17
      DUP.DTL=''                         ; * JMK17
      PR.PROCESS.DTL=''                  ; * JMK17
      UPS.PROCESS.DTL=''                 ; * JMK17
      UPS.TRACK.DTL=''                   ; * JMK17
      WEEK.FLAT.DTL=''                   ; * JMK17
      WEEK.PSTG.DTL=''                   ; * JMK17
      WEEK.AFSI.DTL=''                   ; * JMK17
      WEEK.PULSE.TMS.DTL=''              ; * DRFZZ
      PER.ANALYTICS.DTL=''                     ; * DRF20
      PER.UPS.DTL=''                     ; * JMK17
      PER.SVC.DTL=''                     ; * JMK17
      PER.LOG.DTL=''                     ; * JMK17
      ALLOC.LOG.DTL=''                   ; * JMK17
      PROCESS.DTL=''                     ; * JMK17
      MINIMUM.DTL=''                     ; * JMK17
*
* DEFINE OUTGOING ARGUMENTS AND ASSOCIATIONS
*
      VOUT=''
***********************************************************
* DEFINE THE RATE BASES
***********************************************************
      LOCATE PROC.DATE IN CLIENT.REC<84> BY 'AR' SETTING POS ELSE POS=POS-1
*
* SET MINIMUM LIMITS
*
      MINIMUM=(((CLIENT.REC<36,POS>*12)/365.25)*DAYS)'R0'
      MINIMUM.RATE=MINIMUM

      DTL.DESC='AFS Contract Minimum processing fee'         ; * JMK17
      DTL.QTY=DAYS                       ; * JMK17
      DTL.RATE=((CLIENT.REC<36,POS>*12)/365.25)    ; * JMK17
      DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)       ; * JMK17
      MINIMUM.DTL=DTL.LINE               ; * JMK17
*
* SET PER BILL RATES
*
      PSTG.RATE=CLIENT.REC<35,POS>
      REJECT.PSTG.RATE=CLIENT.REC<185,POS>
      REG.RATE=CLIENT.REC<73,POS>/10
      EDI.LTL.RATE=CLIENT.REC<122,POS>/10
      EDI.PARCEL.RATE=CLIENT.REC<172,POS>/10
      PR.RATE=CLIENT.REC<190,POS>/10
      UPS.TRACK.RATE=CLIENT.REC<199,POS>/10
      PRE.AUDIT.RATE=CLIENT.REC<132,POS>/10
      REJECT.RATE=CLIENT.REC<317,POS>/10
*
* SET FLAT RATES
*
      WEEK.FLAT.RATE=CLIENT.REC<40,POS>
      WEEK.PSTG.RATE=CLIENT.REC<129,POS>
      WEEK.AFSI.RATE=CLIENT.REC<130,POS>
      WEEK.PULSE.TMS.RATE=CLIENT.REC<307,POS>      ; * DRFZZ
      PER.SVC.RATE=CLIENT.REC<32,POS>
      PER.LOG.RATE=CLIENT.REC<128,POS>
      PER.UPS.RATE=CLIENT.REC<113,POS>
      PER.ANALYTICS.RATE=CLIENT.REC<308,POS>    ; * DRF20
*
* SET TRANSPORT MODE FLAT RATE ALLOCATIONS
*
      PER.TRN.CODE=CLIENT.REC<208,POS>   ; * JMK05
      PER.TRN.FEE=CLIENT.REC<209,POS>    ; * JMK05
      PER.TRN.PCT=CLIENT.REC<210,POS>    ; * JMK05
      PER.TRN.MIN=CLIENT.REC<211,POS>    ; * JMK05
      PER.TRN.CAP=CLIENT.REC<212,POS>    ; * JMK06
      PER.TRN.MAX=CLIENT.REC<213,POS>    ; * JMK05
*
* SET CARRIER FLAT RATE ALLOCATIONS
*
      PER.CAR.CODE=CLIENT.REC<214,POS>   ; * JMK14
      PER.CAR.FEE=CLIENT.REC<215,POS>    ; * JMK14
      PER.CAR.PCT=CLIENT.REC<216,POS>    ; * JMK14
      PER.CAR.MIN=CLIENT.REC<217,POS>    ; * JMK14
      PER.CAR.CAP=CLIENT.REC<218,POS>    ; * JMK14
      PER.CAR.MAX=CLIENT.REC<219,POS>    ; * JMK14
***********************************************************
*
* START WITH POSTAGE CALCULATION
*
***********************************************************
      PSTG.FEE = (CARRIER.CNT*PSTG.RATE)'R0'
*DF      IF USER='FDAVID' THEN
*DF         PSTG.FEE = (NON.VOUCHER.CARRIER.CNT*PSTG.RATE)'R0'
*DF      END
      IF BUILD.DTL AND PSTG.FEE+0#0 THEN           ; * JMK17
         DTL.DESC='Postage for normal correspondence with carrier(s)'  ; * JMK17
         DTL.QTY=CARRIER.CNT             ; * JMK17
         DTL.RATE=PSTG.RATE              ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         PSTG.DTL=DTL.LINE               ; * JMK17
      END                                ; * JMK17

      IF CLIENT.ID='01308' THEN
         REJECT.PSTG.FEE = (REJECT.CNT*REJECT.PSTG.RATE)'R0'
         IF BUILD.DTL AND REJECT.PSTG.FEE+0#0 THEN           ; * JMK17
            DTL.DESC='Postage for reject correspondence with carrier(s)'         ; * JMK17
            DTL.QTY=REJECT.CNT           ; * JMK17
            DTL.RATE=REJECT.PSTG.RATE    ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            REJECT.PSTG.DTL=DTL.LINE     ; * JMK17
         END                             ; * JMK17
      END
      IF PB.PSTG='Y' AND CARRIER.CNT#'0' AND CLIENT.ID#'01308' THEN    ; * JMK03
         REJECT.PSTG.FEE = (REJECT.CNT*REJECT.PSTG.RATE)'R0'
         IF BUILD.DTL AND REJECT.PSTG.FEE+0#0 THEN           ; * JMK17
            DTL.DESC='Postage for reject correspondence with carrier(s)'         ; * JMK17
            DTL.QTY=REJECT.CNT           ; * JMK17
            DTL.RATE=REJECT.PSTG.RATE    ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            REJECT.PSTG.DTL=DTL.LINE     ; * JMK17
         END                             ; * JMK17
         STC.BILL.OZS = INT((PPR.BILLS.CNT*FB.OZ)+.99)
         PRCL.RATE=PSTG.RATE             ; * JMK12
         IF PRCL.RATE+0#0 THEN           ; * JMK12
            PRCL.RATE=USPS.PRCL.RATE     ; * JMK12 - SET BASED ON TABLE ABOVE
         END                             ; * JMK12
         STC.PSTG.FEE = (STC.BILL.OZS*PRCL.RATE)'R0'         ; * JMK12
         IF LOGISTICS THEN STC.PSTG.FEE=0          ; * JMK01
         IF CLIENT.ID='01322' THEN STC.PSTG.FEE=0  ; * JMKXXX
         IF BUILD.DTL AND STC.PSTG.FEE+0#0 THEN    ; * JMK17
            DTL.DESC='Postage for interoffice correspondence'          ; * JMK17
            DTL.QTY=STC.BILL.OZS         ; * JMK17
            DTL.RATE=PRCL.RATE           ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            STC.PSTG.DTL=DTL.LINE        ; * JMK17
         END                             ; * JMK17
      END
      POSTAGE.FEE=PSTG.FEE+REJECT.PSTG.FEE+STC.PSTG.FEE
*
* SET RETURN ARGUMENT VARIABLE
*
      VOUT<01>=PSTG.FEE
      VOUT<02>=REJECT.PSTG.FEE
      VOUT<03>=STC.PSTG.FEE
      VOUT<04>=POSTAGE.FEE

      IF CLIENT.ID='01517' AND SEP.DIV+0#0 THEN    ; * JMK10
         VOUT<04>=0                      ; * JMK10
         PSTG.DTL=''                     ; * JMK17
         REJEST.PSTG.DTL=''              ; * JMK17
         STC.PSTG.DTL=''                 ; * JMK17
      END                                ; * JMK10
      IF CLIENT.ID='01499' AND SEP.DIV+0#0 THEN    ; * JMK34
         IF DIV.CODE[1,5]#'00001' THEN   ; * JMK34
            VOUT<04>=0                   ; * JMK34
            PSTG.DTL=''                  ; * JMK34
            REJEST.PSTG.DTL=''           ; * JMK34
            STC.PSTG.DTL=''              ; * JMK34
         END                             ; * JMK34
      END                                ; * JMK34
      IF CLIENT.ID='01682' AND SEP.DIV+0#0 THEN    ; * JMK38
         IF DIV.CODE[1,5]#'00001' THEN   ; * JMK38
            VOUT<04>=0                   ; * JMK38
            PSTG.DTL=''                  ; * JMK38
            REJEST.PSTG.DTL=''           ; * JMK38
            STC.PSTG.DTL=''              ; * JMK38
         END                             ; * JMK38
      END                                ; * JMK38
      IF CLIENT.ID='02084' AND SEP.DIV+0#0 THEN    ; * JMK40

         IF DIV.CODE[1,5]#'00015' THEN   ; * JMK40; * DRF11
            VOUT<04>=0                   ; * JMK40
            PSTG.DTL=''                  ; * JMK40
            REJEST.PSTG.DTL=''           ; * JMK40
            STC.PSTG.DTL=''              ; * JMK40
         END                             ; * JMK40
      END                                ; * JMK40
***********************************************************
*
* PRE AUDIT FEE CALCULATION
*
***********************************************************
      PRE.AUDIT.FEE=((BILLS.CNT+DUP.CNT)*PRE.AUDIT.RATE)'R0'
      IF CLIENT.ID='01342' AND END.DATE GE '18523' THEN
         PRE.AUDIT.FEE=((BILLS.CNT+DUP.CNT-EDI.PARCEL.CNT)*PRE.AUDIT.RATE)'R0'
      END
      IF BUILD.DTL AND PRE.AUDIT.FEE+0#0 THEN      ; * JMK17
         DTL.LINE=''                     ; * JMK17
         DTL.DESC='Handling fee prior to audit review'       ; * JMK17
         DTL.QTY=BILLS.CNT+DUP.CNT       ; * JMK17
         DTL.RATE=PRE.AUDIT.RATE         ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         IF CLIENT.ID='01342' AND END.DATE GE '18523' THEN
            DTL.QTY=BILLS.CNT+DUP.CNT-EDI.PARCEL.CNT       ; * JMK17
            DTL.RATE=PRE.AUDIT.RATE         ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         END
         PRE.AUDIT.DTL=DTL.LINE          ; * JMK17
      END                                ; * JMK17
*
* SET RETURN ARGUMENT VARIABLE
*
      VOUT<05>=PRE.AUDIT.FEE

*
* PER BILL PROCESSING FEE CALCULATION
*

*
* PERFORM NORMAL PROCESSING CALCULATIONS
*
      PPR.BILLS.FEE = (PPR.BILLS.CNT*REG.RATE)'R0'
      IF BUILD.DTL AND PPR.BILLS.FEE+0#0 THEN      ; * JMK17
         DTL.DESC='Paper Per Bill Fee'   ; * JMK17
         DTL.QTY=PPR.BILLS.CNT           ; * JMK17
         DTL.RATE=REG.RATE               ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         PPR.BILLS.DTL=DTL.LINE          ; * JMK17
      END                                ; * JMK17
      EDI.LTL.FEE = (EDI.LTL.CNT*EDI.LTL.RATE)'R0'
      IF BUILD.DTL AND EDI.LTL.FEE+0#0 THEN        ; * JMK17
         DTL.DESC='EDI LTL Per Bill Fee'           ; * JMK17
         DTL.QTY=EDI.LTL.CNT             ; * JMK17
         DTL.RATE=EDI.LTL.RATE           ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         EDI.LTL.DTL=DTL.LINE            ; * JMK17
      END                                ; * JMK17
      EDI.PARCEL.FEE = (EDI.PARCEL.CNT*EDI.PARCEL.RATE)'R0'
      IF BUILD.DTL AND EDI.PARCEL.FEE+0#0 THEN     ; * JMK17
         DTL.DESC='EDI Parcel Per Bill Fee'        ; * JMK17
         DTL.QTY=EDI.PARCEL.CNT          ; * JMK17
         DTL.RATE=EDI.PARCEL.RATE        ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         EDI.PARCEL.DTL=DTL.LINE         ; * JMK17
      END                                ; * JMK17
      DUP.FEE = (DUP.CNT*REG.RATE)'R0'
      IF CLIENT.ID='06902' OR CLIENT.ID='06903' OR CLIENT.ID='06904' OR CLIENT.ID='06905' OR CLIENT.ID='06906' OR CLIENT.ID='06908' THEN         ; * DRF30
         DUP.FEE = (DUP.CNT*105)'R0'
       END
      IF BUILD.DTL AND DUP.FEE+0#0 THEN  ; * JMK17
         DTL.DESC='Duplicate Per Bill Fee'         ; * JMK17
         DTL.QTY=DUP.CNT                 ; * JMK17
         DTL.RATE=REG.RATE               ; * JMK17
         IF CLIENT.ID='06902' OR CLIENT.ID='06903' OR CLIENT.ID='06904' OR CLIENT.ID='06905' OR CLIENT.ID='06906' OR CLIENT.ID='06908' THEN         ; * DRF30
            DUP.RATE = 105
          END
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         DUP.DTL=DTL.LINE                ; * JMK17
      END                                ; * JMK17
      PR.PROCESS.FEE = (PR.BILLS.CNT*PR.RATE)'R0'
      IF BUILD.DTL AND PR.PROCESS.FEE+0#0 THEN     ; * JMK17
         DTL.DESC='Pro-Rated Per Bill Fee'         ; * JMK17
         DTL.QTY=PR.BILLS.CNT            ; * JMK17
         DTL.RATE=PR.RATE                ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         PR.PROCESS.DTL=DTL.LINE         ; * JMK17
      END                                ; * JMK17
      UPS.PROCESS.FEE = (UPS.BILLS.CNT*EDI.PARCEL.RATE)'R0'
      IF BUILD.DTL AND UPS.PROCESS.FEE+0#0 THEN    ; * JMK17
         DTL.DESC='UPS Per Bill Fee'     ; * JMK17
         DTL.QTY=UPS.BILLS.CNT           ; * JMK17
         DTL.RATE=EDI.PARCEL.RATE        ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         UPS.PROCESS.DTL=DTL.LINE        ; * JMK17
      END                                ; * JMK17
      UPS.TRACK.FEE = (UPS.TRACK.CNT*UPS.TRACK.RATE)'R0'
      IF BUILD.DTL AND UPS.TRACK.FEE+0#0 THEN      ; * JMK17
         DTL.DESC='UPS Per Tracking Number Fee'    ; * JMK17
         DTL.QTY=UPS.TRACK.CNT           ; * JMK17
         DTL.RATE=UPS.TRACK.RATE         ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         UPS.TRACK.DTL=DTL.LINE          ; * JMK17
      END                                ; * JMK17
      REJECT.FEE = (CURR.REJ.CNT*REJECT.RATE)'R0'
      IF BUILD.DTL AND REJECT.FEE+0#0 THEN  ; * JMK17
         DTL.DESC='Reject Per Bill Fee'         ; * JMK17
         DTL.QTY=CURR.REJ.CNT                 ; * JMK17
         DTL.RATE=REJECT.RATE               ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         DUP.DTL=DTL.LINE                ; * JMK17
      END                                ; * JMK17
*
* NOW PERFORM CLIENT SPECIFIC CALCULATIONS
*
      BEGIN CASE
         CASE CLIENT.ID='00761'
            IF END.DATE LT 12798 THEN
               EDI.PARCEL.FEE=(EDI.PARCEL.CNT*23)'R0'
               IF BUILD.DTL AND EDI.PARCEL.FEE+0#0 THEN      ; * JMK17
                  DTL.DESC='EDI Parcel Per Bill Fee'         ; * JMK17
                  DTL.QTY=EDI.PARCEL.CNT           ; * JMK17
                  DTL.RATE=23            ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  EDI.PARCEL.DTL=DTL.LINE          ; * JMK17
               END                       ; * JMK17
            END ELSE
               EDI.PARCEL.FEE=(EDI.PARCEL.CNT*7)'R0'
               IF BUILD.DTL AND EDI.PARCEL.FEE+0#0 THEN      ; * JMK17
                  DTL.DESC='EDI Parcel Per Bill Fee'         ; * JMK17
                  DTL.QTY=EDI.PARCEL.CNT           ; * JMK17
                  DTL.RATE=7             ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  EDI.PARCEL.DTL=DTL.LINE          ; * JMK17
               END                       ; * JMK17
            END
        ** CASE CLIENT.REC<316> ; * DRF23
        
         CASE CLIENT.REC<316>=1         ; * DRF23
*DF            PPR.BILLS.FEE = (LTL.COUNT*770)'R0'    ; * DRF23
*DF            PPR.BILLS.FEE = (LTL.COUNT*765)'R0'    ; * DRF23
*DF            PPR.BILLS.FEE = (LTL.COUNT*762.5)'R0'    ; * DRF24 ; * DRF25
*DF            PPR.BILLS.FEE = (LTL.COUNT*760)'R0'    ; * DRF25    ; * DRF26
*DF            PPR.BILLS.FEE = (LTL.COUNT*855)'R0'    ; * DRF26 ; * DRF27
*DF            PPR.BILLS.FEE = (LTL.COUNT*910)'R0'    ; * DRF27
*DF            PPR.BILLS.FEE = (LTL.COUNT*912.5)'R0'    ; * DRF28
            PPR.BILLS.FEE = (LTL.COUNT*943)'R0'    ; * DRF29
            IF BUILD.DTL AND PPR.BILLS.FEE+0#0 THEN      ; * JMK17
               DTL.DESC='LTL Per Bill Fee'   ; * JMK17
               DTL.QTY=LTL.COUNT           ; * JMK17
*DF               DTL.RATE=770               ; * JMK17
*DF               DTL.RATE=765               ; * JMK17
*DF               DTL.RATE=762.5               ; * DRF24 ; * DRF25
*DF               DTL.RATE=760               ; * DRF25    ; * DRF26
*DF               DTL.RATE=855               ; * DRF26 ; * DRF27
*DF               DTL.RATE=910               ; * DRF27
*DF               DTL.RATE=912.5               ; * DRF28
               DTL.RATE=943               ; * DRF29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
               PPR.BILLS.DTL=DTL.LINE          ; * JMK17
            END                                ; * JMK17
*DF            EDI.PARCEL.FEE = (NON.LTL.COUNT*55)'R0'
*DF            EDI.PARCEL.FEE = (NON.LTL.COUNT*50)'R0'
*DF            EDI.PARCEL.FEE = (NON.LTL.COUNT*47.5)'R0'     ; *DRF24 ; * DRF25
*DF            EDI.PARCEL.FEE = (NON.LTL.COUNT*45)'R0'     ; *DRF25    ; * DRF26
*DF            EDI.PARCEL.FEE = (NON.LTL.COUNT*50)'R0'     ; *DRF28
*DF            EDI.PARCEL.FEE = (NON.LTL.COUNT*52.5)'R0'     ; *DRF26
            EDI.PARCEL.FEE = (NON.LTL.COUNT*57)'R0'     ; *DRF29
            IF BUILD.DTL AND EDI.PARCEL.FEE+0#0 THEN      ; * JMK17
               DTL.DESC='Non LTL Per Bill Fee'   ; * JMK17
               DTL.QTY=NON.LTL.COUNT           ; * JMK17
*DF               DTL.RATE=55               ; * JMK17
*DF               DTL.RATE=50               ; * JMK17
*DF               DTL.RATE=47.5               ; * DRF24 ; * DRF25
*DF               DTL.RATE=45               ; * DRF25    ; * DRF26
*DF               DTL.RATE=50               ; * DRF26
*DF               DTL.RATE=52.5               ; * DRF28
               DTL.RATE=57               ; * DRF28
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
               EDI.PARCEL.DTL=DTL.LINE          ; * JMK17
            END                                ; * JMK17
         CASE CLIENT.ID='05171'         
            PPR.BILLS.FEE = (LTL.COUNT*895)'R0'    ; * NKH01
            IF BUILD.DTL AND PPR.BILLS.FEE+0#0 THEN      
               DTL.DESC='LTL Per Bill Fee'   
               DTL.QTY=LTL.COUNT           
               DTL.RATE=895                        ; * NKH01
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    
               PPR.BILLS.DTL=DTL.LINE          
            END                                
            EDI.PARCEL.FEE = (NON.LTL.COUNT*0)'R0'
            IF BUILD.DTL AND EDI.PARCEL.FEE+0#0 THEN      
               DTL.DESC='Non LTL Per Bill Fee'   
               DTL.QTY=NON.LTL.COUNT           
               DTL.RATE=0               
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    
               EDI.PARCEL.DTL=DTL.LINE          
            END                                
         CASE CLIENT.ID='06891' OR CLIENT.ID='06898'
            PPR.BILLS.FEE = (LTL.COUNT*EDI.LTL.RATE)'R0'   
            IF BUILD.DTL AND PPR.BILLS.FEE+0#0 THEN      
               DTL.DESC='LTL Per Bill Fee'   
               DTL.QTY=LTL.COUNT           
               DTL.RATE=EDI.LTL.RATE               
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    
               PPR.BILLS.DTL=DTL.LINE          
            END                                
            EDI.PARCEL.FEE = (NON.LTL.COUNT*REG.RATE)'R0'
            IF BUILD.DTL AND EDI.PARCEL.FEE+0#0 THEN      
               DTL.DESC='Non LTL Per Bill Fee'   
               DTL.QTY=NON.LTL.COUNT           
               DTL.RATE=REG.RATE               
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    
               EDI.PARCEL.DTL=DTL.LINE          
            END                                
         CASE CLIENT.ID='06902' OR CLIENT.ID='06903' OR CLIENT.ID='06904' OR CLIENT.ID='06905' OR CLIENT.ID='06906' OR CLIENT.ID='06908'         ; * DRF30
            PPR.BILLS.FEE = (INTL.COUNT*150)'R0'    ; * DRF30
            IF BUILD.DTL AND PPR.BILLS.FEE+0#0 THEN      ; * JMK17
               DTL.DESC='INTL Per Bill Fee'   ; * JMK17
               DTL.QTY=INTL.COUNT           ; * JMK17
               DTL.RATE=150               ; * DRF30
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
               PPR.BILLS.DTL=DTL.LINE          ; * JMK17
            END                                ; * JMK17
            EDI.PARCEL.FEE = (NON.INTL.COUNT*105)'R0'     ; *DRF30
            IF BUILD.DTL AND EDI.PARCEL.FEE+0#0 THEN      ; * JMK17
               DTL.DESC='Non INTL Per Bill Fee'   ; * JMK17
               DTL.QTY=NON.INTL.COUNT           ; * JMK17
               DTL.RATE=105               ; * DRF30
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
               EDI.PARCEL.DTL=DTL.LINE          ; * JMK17
            END                                ; * JMK17

      END CASE
*
* SET RETURN ARGUMENT VARIABLE
*
      VOUT<06>=PPR.BILLS.FEE
      VOUT<07>=EDI.LTL.FEE
      VOUT<08>=EDI.PARCEL.FEE
      VOUT<09>=DUP.FEE
      VOUT<10>=PR.PROCESS.FEE
      VOUT<11>=UPS.PROCESS.FEE
      VOUT<12>=UPS.TRACK.FEE
*
* ACCUMULATE ALL FEES INTO ONE PROCESS FEE
*
      PROCESS.FEE+=PPR.BILLS.FEE
      PROCESS.FEE+=EDI.LTL.FEE
      PROCESS.FEE+=EDI.PARCEL.FEE
      PROCESS.FEE+=DUP.FEE
      PROCESS.FEE+=PR.PROCESS.FEE
      PROCESS.FEE+=REJECT.FEE
      PROCESS.FEE=PROCESS.FEE'R0'        ; * Round the Final Answer
*
* SET RETURN ARGUMENT VARIABLE
*
      VOUT<13>=PROCESS.FEE
      IF PRE.AUDIT.FEE+0=0 THEN          ; * JMK02
         IF PROCESS.FEE LT MINIMUM THEN  ; * JMK02
            PROCESS.FEE=MINIMUM          ; * JMK02
         END                             ; * JMK02
      END ELSE                           ; * JMK02
         IF (PROCESS.FEE+PRE.AUDIT.FEE)#0 THEN
            IF (PROCESS.FEE+PRE.AUDIT.FEE) LT MINIMUM THEN
               IF PROCESS.FEE+PRE.AUDIT.FEE=0 THEN
                  PROCESS.PCT=0
               END ELSE
                  PROCESS.PCT=PROCESS.FEE/(PROCESS.FEE+PRE.AUDIT.FEE)
               END
               PROCESS.FEE=(MINIMUM*PROCESS.PCT)'R0'
               PRE.AUDIT.FEE=MINIMUM-PROCESS.FEE
            END
         END
      END                                ; * JMK02

*
* FLAT FEE PROCESSING FEE CALCULATION
*
*
* PERFORM NORMAL FLAT FEE CALCULATIONS
*
      IF DAYS=7 THEN
         WEEK.FLAT.FEE = WEEK.FLAT.RATE
         WEEK.PSTG.FEE = WEEK.PSTG.RATE
         WEEK.AFSI.FEE = WEEK.AFSI.RATE
         WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE  ; * DRFZZ
         PER.UPS.FEE = PER.UPS.RATE
         PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat Fee for 1 week'         ; * JMK17
            DTL.QTY=1                    ; * JMK17
            DTL.RATE=WEEK.FLAT.RATE      ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.FLAT.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat Process & Handling Fee for 1 week'          ; * JMK17
            DTL.QTY=1                    ; * JMK17
            DTL.RATE=WEEK.PSTG.RATE      ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.PSTG.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat AFSi Fee for 1 week'    ; * JMK17
            DTL.QTY=1                    ; * JMK17
            DTL.RATE=WEEK.AFSI.RATE      ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.AFSI.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * DRFZZ
            DTL.DESC='Flat PulseTMS Fee for 1 week'          ; * DRFZZ
            DTL.QTY=1                    ; * DRFZZ
            DTL.RATE=WEEK.PULSE.TMS.RATE           ; * DRFZZ
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * DRFZZ
            WEEK.PULSE.TMS.DTL=DTL.LINE  ; * DRFZZ
         END                             ; * DRFZZ
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN        ; * DRF20
            DTL.DESC='Flat Analytics Fee for 1 week'          ; * DRF20
            DTL.QTY=1                    ; * DRF20
            DTL.RATE=PER.ANALYTICS.RATE           ; * DRF20
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * DRF20
            PER.ANALYTICS.DTL=DTL.LINE  ; * DRF20
         END                             ; * DRF20
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * JMK17
            DTL.DESC='Flat UPS Service Fee for 1 week'       ; * JMK17
            DTL.QTY=1                    ; * JMK17
            DTL.RATE=PER.UPS.RATE        ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            PER.UPS.DTL=DTL.LINE         ; * JMK17
         END                             ; * JMK17
      END ELSE
         WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'
         WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'
         WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'
         WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'       ; * DRFZZ
         PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'       ; * DRF20
         PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat Fee for ':DAYS:' days'  ; * JMK17
            DTL.QTY=DAYS                 ; * JMK17
            DTL.RATE=WEEK.FLAT.RATE/7    ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.FLAT.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat Process & Handling Fee for ':DAYS:' days'   ; * JMK17
            DTL.QTY=DAYS                 ; * JMK17
            DTL.RATE=WEEK.PSTG.RATE/7    ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.PSTG.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat AFSi Fee for ':DAYS:' days'       ; * JMK17
            DTL.QTY=DAYS                 ; * JMK17
            DTL.RATE=WEEK.AFSI.RATE/7    ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.AFSI.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * DRFZZ
            DTL.DESC='Flat PulseTMS Fee for ':DAYS:' days'   ; * DRFZZ
            DTL.QTY=DAYS                 ; * DRFZZ
            DTL.RATE=WEEK.PULSE.TMS.RATE/7         ; * DRFZZ
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * DRFZZ
            WEEK.PULSE.TMS.DTL=DTL.LINE  ; * DRFZZ
         END                             ; * DRFZZ
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN        ; * DRF20
            DTL.DESC='Flat Analytics Fee for ':DAYS:' days'   ; * DRF20
            DTL.QTY=DAYS                 ; * DRF20
            DTL.RATE=PER.ANALYTICS.RATE/7         ; * DRF20
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * DRF20
            PER.ANALYTICS.DTL=DTL.LINE  ; * DRF20
         END                             ; * DRF20
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * JMK17
            DTL.DESC='Flat UPS Service Fee for ':DAYS:' days'          ; * JMK17
            DTL.QTY=DAYS                 ; * JMK17
            DTL.RATE=PER.UPS.RATE/7      ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            PER.UPS.DTL=DTL.LINE         ; * JMK17
         END                             ; * JMK17
      END

      DIV.CALC=0                         ; * JMK08



      IF CLIENT.ID='01067' THEN DIV.CALC=1         ; * JMK08

      IF CLIENT.ID='01436' THEN DIV.CALC=1
      IF CLIENT.ID='01755' THEN DIV.CALC=1
      IF CLIENT.ID='01468' THEN DIV.CALC=1

      IF CLIENT.ID='01682' THEN DIV.CALC=1         ; * JMK38
      IF CLIENT.ID='01760' THEN DIV.CALC=1
      IF CLIENT.ID='01932' THEN DIV.CALC=1
      IF CLIENT.ID='01949' THEN DIV.CALC=1         ; * JMK39
      IF CLIENT.ID='02172' THEN DIV.CALC=1         ; * DRF03
      IF CLIENT.ID='05234' THEN DIV.CALC=1         ; * DRF03

      IF DIV.CALC THEN                   ; * JMK08

         DIV.CODE.COUNT=DCOUNT(DIV.CODE,@VM)       ; * JMK08
         IF MULTI.PROC.DATE THEN
            WEEK.FLAT.FEE=WEEK.FLAT.RATE
            WEEK.PSTG.FEE=WEEK.PSTG.RATE
            WEEK.AFSI.FEE=WEEK.AFSI.RATE
            WEEK.PULSE.TMS.FEE=WEEK.PULSE.TMS.RATE           ; * DRFZZ
            PER.ANALYTICS.FEE=PER.ANALYTICS.RATE    ; * DRF20
            PER.UPS.FEE=PER.UPS.RATE
         END
         WEEK.FLAT.FEE = WEEK.FLAT.FEE*DIV.CODE.COUNT
         WEEK.PSTG.FEE = WEEK.PSTG.FEE*DIV.CODE.COUNT
         WEEK.AFSI.FEE = WEEK.AFSI.FEE*DIV.CODE.COUNT
         WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.FEE*DIV.CODE.COUNT        ; * DRFZZ
         PER.ANALYTICS.FEE = PER.ANALYTICS.FEE*DIV.CODE.COUNT        ; * DRF20
         PER.UPS.FEE = PER.UPS.FEE*DIV.CODE.COUNT
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat Fee for ':DIV.CODE.COUNT:' divisions'       ; * JMK17
            DTL.QTY=DIV.CODE.COUNT       ; * JMK17
            DTL.RATE=WEEK.FLAT.RATE      ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.FLAT.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat Process & Handling Fee for ':DIV.CODE.COUNT:' divisions'        ; * JMK17
            DTL.QTY=DIV.CODE.COUNT       ; * JMK17
            DTL.RATE=WEEK.PSTG.RATE      ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.PSTG.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * JMK17
            DTL.DESC='Flat AFSi Fee for ':DIV.CODE.COUNT:' divisions'  ; * JMK17
            DTL.QTY=DIV.CODE.COUNT       ; * JMK17
            DTL.RATE=WEEK.AFSI.RATE      ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.AFSI.DTL=DTL.LINE       ; * JMK17
         END                             ; * JMK17
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * DRFZZ
            DTL.DESC='Flat PulseTMS Fee for ':DIV.CODE.COUNT:' divisions'        ; * DRFZZ
            DTL.QTY=DIV.CODE.COUNT       ; * JMK17
            DTL.RATE=WEEK.PULSE.TMS.RATE           ; * DRFZZ
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            WEEK.PULSE.TMS.DTL=DTL.LINE  ; * DRFZZ
         END                             ; * DRFZZ
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN        ; * DRF20
            DTL.DESC='Flat Analytics Fee for ':DIV.CODE.COUNT:' divisions'        ; * DRF20
            DTL.QTY=DIV.CODE.COUNT       ; * DRF20
            DTL.RATE=PER.ANALYTICS.RATE           ; * DRF20
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * DRF20
            PER.ANALYTICS.DTL=DTL.LINE  ; * DRF20
         END                             ; * DRF20
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * JMK17
            DTL.DESC='Flat UPS Service Fee for ':DIV.CODE.COUNT:' divisions'     ; * JMK17
            DTL.QTY=DIV.CODE.COUNT       ; * JMK17
            DTL.RATE=PER.UPS.RATE        ; * JMK17
            DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)           ; * JMK17
            PER.UPS.DTL=DTL.LINE         ; * JMK17
         END                             ; * JMK17
      END
      IF CLIENT.ID='01003' AND SEP.DIV+0#0 THEN    ; * JMK07
         WEEK.FLAT.FEE = 0               ; * JMK07
         WEEK.PSTG.FEE = 0               ; * JMK07
         WEEK.AFSI.FEE = 0               ; * JMK07
         WEEK.PULSE.TMS.FEE = 0          ; * DRFZZ
         PER.ANALYTICS.FEE = 0                 ; * DRF20
         PER.UPS.FEE = 0                 ; * JMK07
         WEEK.FLAT.DTL=''                ; * JMK17
         WEEK.PSTG.DTL=''                ; * JMK17
         WEEK.AFSI.DTL=''                ; * JMK17
         WEEK.PULSE.TMS.DTL=''           ; * DRFZZ
         PER.ANALYTICS.DTL=''                  ; * DRF20
         PER.UPS.DTL=''                  ; * JMK17
      END                                ; * JMK07

      IF CLIENT.ID='01517' AND SEP.DIV+0#0 THEN    ; * JMK10
         WEEK.FLAT.FEE = 0               ; * JMK10
         WEEK.PSTG.FEE = 0               ; * JMK10
         WEEK.AFSI.FEE = 0               ; * JMK10
         WEEK.PULSE.TMS.FEE = 0          ; * DRFZZ
         PER.ANALYTICS.FEE = 0                 ; * DRF20
         PER.UPS.FEE = 0                 ; * JMK10
         WEEK.FLAT.DTL=''                ; * JMK17
         WEEK.PSTG.DTL=''                ; * JMK17
         WEEK.AFSI.DTL=''                ; * JMK17
         WEEK.PULSE.TMS.DTL=''           ; * DRFZZ
         PER.ANALYTICS.DTL=''                  ; * DRF20
         PER.UPS.DTL=''                  ; * JMK17
      END                                ; * JMK10
      IF CLIENT.ID='01706' AND SEP.DIV+0#0 THEN    ; * DRF15
         WEEK.FLAT.FEE = 0               ; * DRF15
         WEEK.PSTG.FEE = 0               ; * DRF15
         WEEK.AFSI.FEE = 0               ; * DRF15
         WEEK.PULSE.TMS.FEE = 0          ; * DRF15
         PER.UPS.FEE = 0                 ; * DRF15
         WEEK.FLAT.DTL=''                ; * DRF15
         WEEK.PSTG.DTL=''                ; * DRF15
         WEEK.AFSI.DTL=''                ; * DRF15
         WEEK.PULSE.TMS.DTL=''           ; * DRF15
         PER.UPS.DTL=''                  ; * DRF15
      END                                ; * DRF15

      IF (CLIENT.ID='01584' OR CLIENT.ID='00937' OR CLIENT.ID='01384' OR CLIENT.ID='01499' OR CLIENT.ID='01682' OR CLIENT.ID='01766' OR CLIENT.ID='01672') AND SEP.DIV+0#0 THEN      ; * JMK29 ; * JMK31 ; * JMK34 ; * JMK38 ; * DRF09
         IF DIV.CODE[1,5]='00001' THEN   ; * JMK29 ; Assign all of the weekly prorated fees to one division (00001)
            IF DAYS=7 THEN               ; * JMK29
               WEEK.FLAT.FEE = WEEK.FLAT.RATE      ; * JMK29
               WEEK.PSTG.FEE = WEEK.PSTG.RATE      ; * JMK29
               WEEK.AFSI.FEE = WEEK.AFSI.RATE      ; * JMK29
               WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE      ; * DRFZZ
               PER.ANALYTICS.FEE = PER.ANALYTICS.RATE      ; * DRF20
               PER.UPS.FEE = PER.UPS.RATE          ; * JMK29
            END ELSE                     ; * JMK29
               WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'           ; * JMK29
               WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'           ; * JMK29
               WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'           ; * JMK29
               WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'           ; * DRFZZ
               PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'           ; * DRF20
               PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'     ; * JMK29
            END                          ; * JMK29
         END ELSE                        ; * JMK29
            WEEK.FLAT.FEE = 0            ; * JMK29
            WEEK.PSTG.FEE = 0            ; * JMK29
            WEEK.AFSI.FEE = 0            ; * JMK29
            WEEK.PULSE.TMS.FEE = 0       ; * DRFZZ
            PER.ANALYTICS.FEE = 0       ; * DRF20
            PER.UPS.FEE = 0              ; * JMK29
         END                             ; * JMK29
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * JMK29
            IF DAYS=7 THEN               ; * JMK29
               DTL.DESC='Flat Fee for each division'         ; * JMK29
               DTL.QTY=1                 ; * JMK29
               DTL.RATE=WEEK.FLAT.RATE   ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               WEEK.FLAT.DTL=DTL.LINE    ; * JMK29
            END ELSE                     ; * JMK29
               DTL.DESC='Flat Fee for ':DAYS:' days'         ; * JMK29
               DTL.QTY=DAYS              ; * JMK29
               DTL.RATE=WEEK.FLAT.RATE/7           ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               WEEK.FLAT.DTL=DTL.LINE    ; * JMK29
            END                          ; * JMK29
         END                             ; * JMK29
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * JMK29
            IF DAYS=7 THEN               ; * JMK29
               DTL.DESC='Flat Process & Handling Fee for each division'          ; * JMK29
               DTL.QTY=1                 ; * JMK29
               DTL.RATE=WEEK.PSTG.RATE   ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               WEEK.PSTG.DTL=DTL.LINE    ; * JMK29
            END ELSE                     ; * JMK29
               DTL.DESC='Flat Process & Handling Fee for ':DAYS:' days'          ; * JMK29
               DTL.QTY=DAYS              ; * JMK29
               DTL.RATE=WEEK.PSTG.RATE/7           ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               WEEK.PSTG.DTL=DTL.LINE    ; * JMK29
            END                          ; * JMK29
         END                             ; * JMK29
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * JMK29
            IF DAYS=7 THEN               ; * JMK29
               DTL.DESC='Flat AFSi Fee for each division'    ; * JMK29
               DTL.QTY=1                 ; * JMK29
               DTL.RATE=WEEK.AFSI.RATE   ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               WEEK.AFSI.DTL=DTL.LINE    ; * JMK29
            END ELSE                     ; * JMK29
               DTL.DESC='Flat AFSi Fee for ':DAYS:' days'    ; * JMK29
               DTL.QTY=DAYS              ; * JMK29
               DTL.RATE=WEEK.AFSI.RATE/7           ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               WEEK.AFSI.DTL=DTL.LINE    ; * JMK29
            END                          ; * JMK29
         END                             ; * JMK29
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * DRFZZ
            IF DAYS=7 THEN               ; * DRFZZ
               DTL.DESC='Flat PulseTMS Fee for each division'          ; * DRFZZ
               DTL.QTY=1                 ; * DRFZZ
               DTL.RATE=WEEK.PULSE.TMS.RATE        ; * DRFZZ
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRFZZ
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRFZZ
            END ELSE                     ; * DRFZZ
               DTL.DESC='Flat PulseTMS Fee for ':DAYS:' days'          ; * DRFZZ
               DTL.QTY=DAYS              ; * DRFZZ
               DTL.RATE=WEEK.PULSE.TMS.RATE/7      ; * DRFZZ
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRFZZ
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRFZZ
            END                          ; * DRFZZ
         END                             ; * DRFZZ
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN        ; * DRF20
            IF DAYS=7 THEN               ; * DRF20
               DTL.DESC='Flat Analytics Fee for each division'          ; * DRF20
               DTL.QTY=1                 ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE        ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE         ; * DRF20
            END ELSE                     ; * DRF20
               DTL.DESC='Flat Analytics Fee for ':DAYS:' days'          ; * DRF20
               DTL.QTY=DAYS              ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE/7      ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE         ; * DRF20
            END                          ; * DRF20
         END                             ; * DRF20
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * JMK29
            IF DAYS=7 THEN               ; * JMK29
               DTL.DESC='Flat UPS Service Fee for each division'       ; * JMK29
               DTL.QTY=1                 ; * JMK29
               DTL.RATE=PER.UPS.RATE     ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               PER.UPS.DTL=DTL.LINE      ; * JMK29
            END ELSE                     ; * JMK29
               DTL.DESC='Flat UPS Service Fee for ':DAYS:' days'       ; * JMK29
               DTL.QTY=DAYS              ; * JMK29
               DTL.RATE=PER.UPS.RATE/7   ; * JMK29
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK29
               PER.UPS.DTL=DTL.LINE      ; * JMK29
            END                          ; * JMK29
         END                             ; * JMK29
      END                                ; * JMK29
      IF (CLIENT.ID='01949') AND SEP.DIV+0#0 THEN  ; * JMK39 ; Assign all of the weekly prorated fees to one division (00001)
         BEGIN CASE                      ; * JMK39
            CASE DIV.CODE[1,5]='00001'   ; * JMK39
               IF DAYS=7 THEN            ; * JMK39
                  WEEK.FLAT.FEE = WEEK.FLAT.RATE   ; * JMK39
                  WEEK.PSTG.FEE = WEEK.PSTG.RATE   ; * JMK39
                  WEEK.AFSI.FEE = WEEK.AFSI.RATE   ; * JMK39
                  WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE   ; * DRFZZ
                  PER.ANALYTICS.FEE = PER.ANALYTICS.RATE   ; * DRF20
                  PER.UPS.FEE = PER.UPS.RATE       ; * JMK39
               END ELSE                  ; * JMK39
                  WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'        ; * JMK39
                  WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'        ; * JMK39
                  WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'        ; * JMK39
                  WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'        ; * DRFZZ
                  PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'        ; * DRF20
                  PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'  ; * JMK39
               END                       ; * JMK39
               WEEK.FLAT.FEE=(WEEK.FLAT.FEE*.7778)'R0'       ; * JMK39
               WEEK.PSTG.FEE=(WEEK.PSTG.FEE*.7778)'R0'       ; * JMK39
               WEEK.AFSI.FEE=(WEEK.AFSI.FEE*.7778)'R0'       ; * JMK39
               WEEK.PULSE.TMS.FEE=(WEEK.PULSE.TMS.FEE*.7778)'R0'       ; * DRF20
               PER.ANALYTICS.FEE=(PER.ANALYTICS.FEE*.7778)'R0'       ; * DRFZZ
               PER.UPS.FEE=(PER.UPS.FEE*.7778)'R0'           ; * JMK39
            CASE DIV.CODE[1,5]='00002'   ; * JMK39
               IF DAYS=7 THEN            ; * JMK39
                  WEEK.FLAT.FEE = WEEK.FLAT.RATE   ; * JMK39
                  WEEK.PSTG.FEE = WEEK.PSTG.RATE   ; * JMK39
                  WEEK.AFSI.FEE = WEEK.AFSI.RATE   ; * JMK39
                  WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE   ; * DRFZZ
                  PER.ANALYTICS.FEE = PER.ANALYTICS.RATE   ; * DRF20
                  PER.UPS.FEE = PER.UPS.RATE       ; * JMK39
               END ELSE                  ; * JMK39
                  WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'        ; * JMK39
                  WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'        ; * JMK39
                  WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'        ; * JMK39
                  WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'        ; * DRFZZ
                  PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'        ; * DRF20
                  PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'  ; * JMK39
               END                       ; * JMK39
               WEEK.FLAT.FEE=(WEEK.FLAT.FEE*.2222)'R0'       ; * JMK39
               WEEK.PSTG.FEE=(WEEK.PSTG.FEE*.2222)'R0'       ; * JMK39
               WEEK.AFSI.FEE=(WEEK.AFSI.FEE*.2222)'R0'       ; * JMK39
               WEEK.PULSE.TMS.FEE=(WEEK.PULSE.TMS.FEE*.2222)'R0'       ; * DRFZZ
               PER.ANALYTICS.FEE=(PER.ANALYTICS.FEE*.2222)'R0'       ; * DRF20
               PER.UPS.FEE=(PER.UPS.FEE*.2222)'R0'           ; * JMK39
            CASE 1                       ; * JMK39
               WEEK.FLAT.FEE = 0         ; * JMK39
               WEEK.PSTG.FEE = 0         ; * JMK39
               WEEK.AFSI.FEE = 0         ; * JMK39
               WEEK.PULSE.TMS.FEE = 0    ; * DRFZZ
               PER.ANALYTICS.FEE = 0    ; * DRF20
               PER.UPS.FEE = 0           ; * JMK39
         END CASE                        ; * JMK39
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * JMK39
            IF DAYS=7 THEN               ; * JMK39
               DTL.DESC='Flat Fee for each division'         ; * JMK39
               DTL.QTY=1                 ; * JMK39
               DTL.RATE=WEEK.FLAT.RATE   ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               WEEK.FLAT.DTL=DTL.LINE    ; * JMK39
            END ELSE                     ; * JMK39
               DTL.DESC='Flat Fee for ':DAYS:' days'         ; * JMK39
               DTL.QTY=DAYS              ; * JMK39
               DTL.RATE=WEEK.FLAT.RATE/7           ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               WEEK.FLAT.DTL=DTL.LINE    ; * JMK39
            END                          ; * JMK39
         END                             ; * JMK39
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * JMK39
            IF DAYS=7 THEN               ; * JMK39
               DTL.DESC='Flat Process & Handling Fee for each division'          ; * JMK39
               DTL.QTY=1                 ; * JMK39
               DTL.RATE=WEEK.PSTG.RATE   ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               WEEK.PSTG.DTL=DTL.LINE    ; * JMK39
            END ELSE                     ; * JMK39
               DTL.DESC='Flat Process & Handling Fee for ':DAYS:' days'          ; * JMK39
               DTL.QTY=DAYS              ; * JMK39
               DTL.RATE=WEEK.PSTG.RATE/7           ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               WEEK.PSTG.DTL=DTL.LINE    ; * JMK39
            END                          ; * JMK39
         END                             ; * JMK39
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * JMK39
            IF DAYS=7 THEN               ; * JMK39
               DTL.DESC='Flat AFSi Fee for each division'    ; * JMK39
               DTL.QTY=1                 ; * JMK39
               DTL.RATE=WEEK.AFSI.RATE   ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               WEEK.AFSI.DTL=DTL.LINE    ; * JMK39
            END ELSE                     ; * JMK39
               DTL.DESC='Flat AFSi Fee for ':DAYS:' days'    ; * JMK39
               DTL.QTY=DAYS              ; * JMK39
               DTL.RATE=WEEK.AFSI.RATE/7           ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               WEEK.AFSI.DTL=DTL.LINE    ; * JMK39
            END                          ; * JMK39
         END                             ; * JMK39
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * DRFZZ
            IF DAYS=7 THEN               ; * DRFZZ
               DTL.DESC='Flat PulseTMS Fee for each division'          ; * DRFZZ
               DTL.QTY=1                 ; * DRFZZ
               DTL.RATE=WEEK.PULSE.TMS.RATE        ; * DRFZZ
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRFZZ
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRFZZ
            END ELSE                     ; * DRFZZ
               DTL.DESC='Flat PulseTMS Fee for ':DAYS:' days'          ; * DRFZZ
               DTL.QTY=DAYS              ; * DRFZZ
               DTL.RATE=WEEK.PULSE.TMS.RATE/7      ; * DRFZZ
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRFZZ
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRFZZ
            END                          ; * DRFZZ
         END                             ; * DRFZZ
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN        ; * DRF20
            IF DAYS=7 THEN               ; * DRF20
               DTL.DESC='Flat Analytics Fee for each division'          ; * DRF20
               DTL.QTY=1                 ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE        ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE         ; * DRF20
            END ELSE                     ; * DRF20
               DTL.DESC='Flat Analytics Fee for ':DAYS:' days'          ; * DRF20
               DTL.QTY=DAYS              ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE/7      ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE         ; * DRF20
            END                          ; * DRF20
         END                             ; * DRF20
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * JMK39
            IF DAYS=7 THEN               ; * JMK39
               DTL.DESC='Flat UPS Service Fee for each division'       ; * JMK39
               DTL.QTY=1                 ; * JMK39
               DTL.RATE=PER.UPS.RATE     ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               PER.UPS.DTL=DTL.LINE      ; * JMK39
            END ELSE                     ; * JMK39
               DTL.DESC='Flat UPS Service Fee for ':DAYS:' days'       ; * JMK39
               DTL.QTY=DAYS              ; * JMK39
               DTL.RATE=PER.UPS.RATE/7   ; * JMK39
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK39
               PER.UPS.DTL=DTL.LINE      ; * JMK39
            END                          ; * JMK39
         END                             ; * JMK39
      END                                ; * JMK39

      IF CLIENT.ID='01436' OR CLIENT.ID='01671' OR CLIENT.ID='01709' OR CLIENT.ID='00666' OR CLIENT.ID='01763' OR CLIENT.ID='01760' OR CLIENT.ID='01932' OR CLIENT.ID='02172' OR CLIENT.ID='05234' OR CLIENT.ID='01755' THEN  ; * JMK16 ; * JMK20 ; * JMK23 ; * JMK24 ; * JMK25 ; * JMK26 ; * JMK28; * DRF02 ; * DRF03 ; * DRF04
         IF SEP.DIV+0=0 THEN             ; * JMK16
*DFDEBUG
            DIV.ARRAY=''                 ; * JMK16
            NDVAL=DCOUNT(DIV.LIST<1>,@VM)          ; * JMK16
            FOR DVAL=1 TO NDVAL          ; * JMK16
               IF DIV.LIST<2,DVAL>#'' THEN         ; * JMK16
                  DIV.ARRAY<1,-1>=DIV.LIST<1,DVAL>           ; * JMK16
               END                       ; * JMK16
            NEXT DVAL                    ; * JMK16
            @USER0=DIV.ARRAY             ; * JMK16

         END ELSE                        ; * JMK16

            DIV.ARRAY=@USER0             ; * JMK16

            DIV.CODE.COUNT=DCOUNT(DIV.ARRAY<1>,@VM)          ; * JMK16
            LOCATE DIV.CODE[1,5] IN DIV.ARRAY<1> SETTING DPOS THEN     ; * JMK16
               IF DPOS=DIV.CODE.COUNT THEN         ; * JMK16
                  WEEK.FLAT.FEE = (WEEK.FLAT.RATE/7*DAYS)'R0'   ; * JMK16
                  WEEK.PSTG.FEE = (WEEK.PSTG.RATE/7*DAYS)'R0'   ; * JMK16
                  WEEK.AFSI.FEE = (WEEK.AFSI.RATE/7*DAYS)'R0'   ; * JMK16
                  WEEK.PULSE.TMS.FEE = (WEEK.PULSE.TMS.RATE/7*DAYS)'R0'   ; * JMK16
                  PER.ANALYTICS.FEE = (PER.ANALYTICS.RATE/7*DAYS)'R0'       ; * DRF20
                  PER.UPS.FEE = (PER.UPS.RATE/7*DAYS)'R0'       ; * JMK16
                  FOR VAL=1 TO DIV.CODE.COUNT-1    ; * JMK16
                     WEEK.FLAT.FEE = WEEK.FLAT.FEE-(WEEK.FLAT.RATE/DIV.CODE.COUNT/7*DAYS)'R0'     ; * JMK16
                     WEEK.PSTG.FEE = WEEK.PSTG.FEE-(WEEK.PSTG.RATE/DIV.CODE.COUNT/7*DAYS)'R0'     ; * JMK16
                     WEEK.AFSI.FEE = WEEK.AFSI.FEE-(WEEK.AFSI.RATE/DIV.CODE.COUNT/7*DAYS)'R0'     ; * JMK16
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.FEE-(WEEK.PULSE.TMS.RATE/DIV.CODE.COUNT/7*DAYS)'R0'          ; * JMK16
                     PER.ANALYTICS.FEE = PER.ANALYTICS.FEE-(PER.ANALYTICS.RATE/DIV.CODE.COUNT/7*DAYS)'R0'           ; * DRF20
                     PER.UPS.FEE = PER.UPS.FEE-(PER.UPS.RATE/DIV.CODE.COUNT/7*DAYS)'R0'           ; * JMK16
                     IF CLIENT.ID='01563' THEN
                        MINIMUM = MINIMUM.RATE
                        TEMP.MINIMUM.RATE=MINIMUM.RATE/DIV.CODE.COUNT
                        TEMP.MINIMUM.RATE=TEMP.MINIMUM.RATE'R0'
                        MINIMUM = MINIMUM-(MINIMUM.RATE/DIV.CODE.COUNT)'R0'
                        MINIMUM = MINIMUM-TEMP.MINIMUM.RATE
                        IF PROCESS.FEE LE MINIMUM THEN PROCESS.FEE=MINIMUM
                     END

                  NEXT VAL               ; * JMK16
               END ELSE                  ; * JMK16
                  WEEK.FLAT.FEE = (WEEK.FLAT.RATE/DIV.CODE.COUNT/7*DAYS)'R0'  ; * JMK16
                  WEEK.PSTG.FEE = (WEEK.PSTG.RATE/DIV.CODE.COUNT/7*DAYS)'R0'  ; * JMK16
                  WEEK.AFSI.FEE = (WEEK.AFSI.RATE/DIV.CODE.COUNT/7*DAYS)'R0'  ; * JMK16
                  WEEK.PULSE.TMS.FEE = (WEEK.PULSE.TMS.RATE/DIV.CODE.COUNT/7*DAYS)'R0'  ; * JMK16
                  PER.ANALYTICS.FEE = (PER.ANALYTICS.RATE/DIV.CODE.COUNT/7*DAYS)'R0'      ; * DRF20
                  PER.UPS.FEE = (PER.UPS.RATE/DIV.CODE.COUNT/7*DAYS)'R0'      ; * JMK16
                  IF CLIENT.ID='01563' THEN
                     MINIMUM = (MINIMUM.RATE/DIV.CODE.COUNT)'R0'
                     IF PROCESS.FEE LE MINIMUM+1 THEN PROCESS.FEE=MINIMUM
                  END

               END                       ; * JMK16
               IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN       ; * JMK17
                  DTL.DESC='Flat Fee for each active division'         ; * JMK17
                  DTL.QTY=1/DIV.CODE.COUNT         ; * JMK17
                  DTL.RATE=WEEK.FLAT.RATE          ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  WEEK.FLAT.DTL=DTL.LINE           ; * JMK17
               END                       ; * JMK17
               IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN       ; * JMK17
                  DTL.DESC='Flat Process & Handling Fee for each active division'          ; * JMK17
                  DTL.QTY=1/DIV.CODE.COUNT         ; * JMK17
                  DTL.RATE=WEEK.PSTG.RATE          ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  WEEK.PSTG.DTL=DTL.LINE           ; * JMK17
               END                       ; * JMK17
               IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN       ; * JMK17
                  DTL.DESC='Flat AFSi Fee for each active division'    ; * JMK17
                  DTL.QTY=1/DIV.CODE.COUNT         ; * JMK17
                  DTL.RATE=WEEK.AFSI.RATE          ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  WEEK.AFSI.DTL=DTL.LINE           ; * JMK17
               END                       ; * JMK17
               IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN  ; * JMK17
                  DTL.DESC='Flat PulseTMS Fee for each active division'          ; * JMK17
                  DTL.QTY=1/DIV.CODE.COUNT         ; * JMK17
                  DTL.RATE=WEEK.PULSE.TMS.RATE     ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  WEEK.PULSE.TMS.DTL=DTL.LINE      ; * JMK17
               END                       ; * JMK17
               IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN         ; * DRF20
                  DTL.DESC='Flat Analytics Fee for each active division'       ; * DRF20
                  DTL.QTY=1/DIV.CODE.COUNT         ; * DRF20
                  DTL.RATE=PER.ANALYTICS.RATE  ; * DRF20
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * DRF20
                  PER.ANALYTICS.DTL=DTL.LINE   ; * DRF20
               END                       ; * DRF20
               IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN         ; * JMK17
                  DTL.DESC='Flat UPS Service Fee for each active division'       ; * JMK17
                  DTL.QTY=1/DIV.CODE.COUNT         ; * JMK17
                  DTL.RATE=PER.UPS.RATE  ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  PER.UPS.DTL=DTL.LINE   ; * JMK17
               END                       ; * JMK17
            END ELSE                     ; * JMK16
               WEEK.FLAT.FEE = 0         ; * JMK16
               WEEK.PSTG.FEE = 0         ; * JMK16
               WEEK.AFSI.FEE = 0         ; * JMK16
               WEEK.PULSE.TMS.FEE = 0    ; * JMK16
               PER.ANALYTICS.FEE = 0           ; * DRF20
               PER.UPS.FEE = 0           ; * JMK16
               WEEK.FLAT.DTL=''          ; * JMK17
               WEEK.PSTG.DTL=''          ; * JMK17
               WEEK.AFSI.DTL=''          ; * JMK17
               WEEK.PULSE.TMS.DTL=''     ; * JMK17
               PER.UPS.DTL=''            ; * JMK17
            END                          ; * JMK16
         END                             ; * JMK16
      END                                ; * JMK16
      IF CLIENT.ID='01401' THEN          ; * JMK42
         BEGIN CASE                      ; * JMK42
            CASE DIV.REG='R'             ; * JMK42
               IF DIV.CODE='US' THEN     ; * JMK42
                  IF DAYS=7 THEN         ; * JMK42
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * JMK42
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * JMK42
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * JMK42
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * JMK42
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * JMK42
                  END ELSE               ; * JMK42
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * JMK42
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * JMK42
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * JMK42
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * JMK42
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * JMK42
                  END                    ; * JMK42
               END ELSE                  ; * JMK42
                  WEEK.FLAT.FEE = 0      ; * JMK42
                  WEEK.PSTG.FEE = 0      ; * JMK42
                  WEEK.AFSI.FEE = 0      ; * JMK42
                  WEEK.PULSE.TMS.FEE = 0           ; * JMK42
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * JMK42
               END                       ; * JMK42
            CASE 1                       ; * JMK42
               IF DIV.CODE[1,5]='00001' THEN       ; * JMK42
                  IF DAYS=7 THEN         ; * JMK42
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * JMK42
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * JMK42
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * JMK42
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * JMK42
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * JMK42
                  END ELSE               ; * JMK42
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * JMK42
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * JMK42
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * JMK42
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * JMK42
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * JMK42
                  END                    ; * JMK42
               END ELSE                  ; * JMK42
                  WEEK.FLAT.FEE = 0      ; * JMK42
                  WEEK.PSTG.FEE = 0      ; * JMK42
                  WEEK.AFSI.FEE = 0      ; * JMK42
                  WEEK.PULSE.TMS.FEE = 0           ; * JMK42
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * JMK42
               END                       ; * JMK42
         END CASE                        ; * JMK42
      END                                ; * JMK42

      IF CLIENT.ID='01283' THEN          ; * DRF06
         BEGIN CASE                      ; * DRF06
            CASE DIV.REG='R'             ; * DRF06
               IF DIV.CODE='SNRGY' THEN  ; * DRF06
                  IF DAYS=7 THEN         ; * DRF06
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF06
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF06
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF06
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF06
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF06
                  END ELSE               ; * DRF06
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF06
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF06
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF06
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF06
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF06
                  END                    ; * DRF06
               END ELSE                  ; * DRF06
                  WEEK.FLAT.FEE = 0      ; * DRF06
                  WEEK.PSTG.FEE = 0      ; * DRF06
                  WEEK.AFSI.FEE = 0      ; * DRF06
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF06
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF06
               END                       ; * DRF06
            CASE 1                       ; * DRF06
               IF DIV.CODE[1,5]='02020' THEN       ; * DRF06
                  IF DAYS=7 THEN         ; * DRF06
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF06
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF06
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF06
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF06
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF06
                  END ELSE               ; * DRF06
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF06
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF06
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF06
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF06
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF06
                  END                    ; * DRF06
               END ELSE                  ; * DRF06
                  WEEK.FLAT.FEE = 0      ; * DRF06
                  WEEK.PSTG.FEE = 0      ; * DRF06
                  WEEK.AFSI.FEE = 0      ; * DRF06
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF06
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF06
               END                       ; * DRF06
         END CASE                        ; * DRF06
      END                                ; * DRF06

      IF CLIENT.ID='01746' THEN          ; * DRF08
         BEGIN CASE                      ; * DRF08
            CASE DIV.REG='R'             ; * DRF08
               IF DIV.CODE='FORT' THEN   ; * DRF08
                  IF DAYS=7 THEN         ; * DRF08
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF08
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF08
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF08
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF08
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF08
                  END ELSE               ; * DRF08
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF08
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF08
                  END                    ; * DRF08
               END ELSE                  ; * DRF08
                  WEEK.FLAT.FEE = 0      ; * DRF08
                  WEEK.PSTG.FEE = 0      ; * DRF08
                  WEEK.AFSI.FEE = 0      ; * DRF08
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF08
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF08
               END                       ; * DRF08
            CASE 1                       ; * DRF08
               IF DIV.CODE[1,5]='00001' THEN       ; * DRF08
                  IF DAYS=7 THEN         ; * DRF08
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF08
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF08
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF08
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF08
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF08
                  END ELSE               ; * DRF08
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF08
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF08
                  END                    ; * DRF08
               END ELSE                  ; * DRF08
                  WEEK.FLAT.FEE = 0      ; * DRF08
                  WEEK.PSTG.FEE = 0      ; * DRF08
                  WEEK.AFSI.FEE = 0      ; * DRF08
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF08
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF08
               END                       ; * DRF08
         END CASE                        ; * DRF08
      END                                ; * DRF08
      IF CLIENT.ID='04866' THEN
         BEGIN CASE
            CASE DIV.REG='R'             ; * DRF08
               IF DIV.CODE='EHINC' THEN    ; * DRF08
                  IF DAYS=7 THEN         ; * DRF08
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF08
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF08
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF08
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF08
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF08
                  END ELSE               ; * DRF08
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF08
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF08
                  END                    ; * DRF08
               END ELSE                  ; * DRF08
                  WEEK.FLAT.FEE = 0      ; * DRF08
                  WEEK.PSTG.FEE = 0      ; * DRF08
                  WEEK.AFSI.FEE = 0      ; * DRF08
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF08
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF08
               END                       ; * DRF08
            CASE 1
               IF DIV.CODE[1,5]='02350' THEN
                  IF DAYS=7 THEN
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE
                  END ELSE
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'    ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'
                  END
               END ELSE
                  WEEK.FLAT.FEE = 0
                  WEEK.PSTG.FEE = 0
                  WEEK.AFSI.FEE = 0
                  WEEK.PULSE.TMS.FEE = 0
                  PER.ANALYTICS.FEE = 0    ; * DRF20
                  PER.UPS.FEE = 0
               END
         END CASE
      END

      *******************************************************
      * Begin GRB01
      IF CLIENT.ID='05702' THEN
         BEGIN CASE
            CASE DIV.REG='R'             ; * DRF08
               IF DIV.CODE='MFG' THEN    ; * DRF08
                  IF DAYS=7 THEN         ; * DRF08
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF08
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF08
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF08
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF08
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF08
                  END ELSE               ; * DRF08
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF08
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF08
                  END                    ; * DRF08
               END ELSE                  ; * DRF08
                  WEEK.FLAT.FEE = 0      ; * DRF08
                  WEEK.PSTG.FEE = 0      ; * DRF08
                  WEEK.AFSI.FEE = 0      ; * DRF08
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF08
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF08
               END                       ; * DRF08
            CASE 1
               IF DIV.CODE[1,5]='00001' THEN
                  IF DAYS=7 THEN
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE
                  END ELSE
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'    ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'
                  END
               END ELSE
                  WEEK.FLAT.FEE = 0
                  WEEK.PSTG.FEE = 0
                  WEEK.AFSI.FEE = 0
                  WEEK.PULSE.TMS.FEE = 0
                  PER.ANALYTICS.FEE = 0    ; * DRF20
                  PER.UPS.FEE = 0
               END
         END CASE
      END
      * End GRB01
      IF CLIENT.ID='05904' THEN
         BEGIN CASE
            CASE DIV.REG='R'             ; * DRF08
               IF DIV.CODE='RPS' THEN    ; * DRF08
                  IF DAYS=7 THEN         ; * DRF08
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF08
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF08
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF08
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF08
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF08
                  END ELSE               ; * DRF08
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF08
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF08
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF08
                  END                    ; * DRF08
               END ELSE                  ; * DRF08
                  WEEK.FLAT.FEE = 0      ; * DRF08
                  WEEK.PSTG.FEE = 0      ; * DRF08
                  WEEK.AFSI.FEE = 0      ; * DRF08
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF08
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF08
               END                       ; * DRF08
            CASE 1
               IF DIV.CODE[1,5]='00008' THEN
                  IF DAYS=7 THEN
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE
                  END ELSE
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'    ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'
                  END
               END ELSE
                  WEEK.FLAT.FEE = 0
                  WEEK.PSTG.FEE = 0
                  WEEK.AFSI.FEE = 0
                  WEEK.PULSE.TMS.FEE = 0
                  PER.ANALYTICS.FEE = 0    ; * DRF20
                  PER.UPS.FEE = 0
               END
         END CASE
      END
      ******************************************************************
      IF CLIENT.ID='30041' THEN     ; * DRF16
         BEGIN CASE     ; * DRF16
            CASE DIV.REG='R'             ; * DRF16
               IF DIV.CODE='VOLEX' THEN    ; * DRF16
                  IF DAYS=7 THEN         ; * DRF16
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF16
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF16
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF16
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF16
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF16
                  END ELSE               ; * DRF16
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF16
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF16
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF16
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF16
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF16
                  END                    ; * DRF16
               END ELSE                  ; * DRF16
                  WEEK.FLAT.FEE = 0      ; * DRF16
                  WEEK.PSTG.FEE = 0      ; * DRF16
                  WEEK.AFSI.FEE = 0      ; * DRF16
                  WEEK.PULSE.TMS.FEE = 0           ; * DRF16
                  PER.ANALYTICS.FEE = 0        ; * DRF20
                  PER.UPS.FEE = 0        ; * DRF16
               END                       ; * DRF16
            CASE 1    ; * DRF16
               IF DIV.CODE[1,5]='00001' THEN    ; * DRF16
                  IF DAYS=7 THEN    ; * DRF16
                     WEEK.FLAT.FEE = WEEK.FLAT.RATE    ; * DRF16
                     WEEK.PSTG.FEE = WEEK.PSTG.RATE    ; * DRF16
                     WEEK.AFSI.FEE = WEEK.AFSI.RATE    ; * DRF16
                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE    ; * DRF16
                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF16
                  END ELSE    ; * DRF16
                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'    ; * DRF16
                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'    ; * DRF16
                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'    ; * DRF16
                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'    ; * DRF16
                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'    ; * DRF20
                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'    ; * DRF16
                  END    ; * DRF16
               END ELSE    ; * DRF16
                  WEEK.FLAT.FEE = 0    ; * DRF16
                  WEEK.PSTG.FEE = 0    ; * DRF16
                  WEEK.AFSI.FEE = 0    ; * DRF16
                  WEEK.PULSE.TMS.FEE = 0    ; * DRF16
                  PER.ANALYTICS.FEE = 0    ; * DRF20
                  PER.UPS.FEE = 0    ; * DRF16
               END    ; * DRF16
         END CASE    ; * DRF16
      END    ; * DRF16
*DF-NEW      IF CLIENT.ID='01755' THEN          ; * DRF07
*DF-NEW         BEGIN CASE                      ; * DRF07
*DF            CASE DIV.REG='R'             ; * DRF07
*DF               IF DIV.CODE='1' THEN      ; * DRF07
*DF                  IF DAYS=7 THEN         ; * DRF07
*DF                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF07
*DF                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF07
*DF                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF07
*DF                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF07
*DF                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF07
*DF                  END ELSE               ; * DRF07
*DF                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF07
*DF                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF07
*DF                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF07
*DF                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF07
*DF                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF07
*DF                  END                    ; * DRF07
*DF               END ELSE                  ; * DRF07
*DF                  WEEK.FLAT.FEE = 0      ; * DRF07
*DF                  WEEK.PSTG.FEE = 0      ; * DRF07
*DF                  WEEK.AFSI.FEE = 0      ; * DRF07
*DF                  WEEK.PULSE.TMS.FEE = 0           ; * DRF07
*DF                  PER.UPS.FEE = 0        ; * DRF07
*DF               END                       ; * DRF07
*DF-NEW            CASE 1                       ; * DRF07
*DF-NEW               IF DIV.CODE[1,5]='00001' THEN       ; * DRF07
*DF-NEW                  IF DAYS=7 THEN         ; * DRF07
*DF-NEW                     WEEK.FLAT.FEE = WEEK.FLAT.RATE          ; * DRF07
*DF-NEW                     WEEK.PSTG.FEE = WEEK.PSTG.RATE          ; * DRF07
*DF-NEW                     WEEK.AFSI.FEE = WEEK.AFSI.RATE          ; * DRF07
*DF-NEW                     WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE          ; * DRF07
*DF-NEW                     PER.ANALYTICS.FEE = PER.ANALYTICS.RATE    ; * DRF20
*DF-NEW                     PER.UPS.FEE = PER.UPS.RATE    ; * DRF07
*DF-NEW                  END ELSE               ; * DRF07
*DF-NEW                     WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'     ; * DRF07
*DF-NEW                     WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'     ; * DRF07
*DF-NEW                     WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'     ; * DRF07
*DF-NEW                     WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'     ; * DRF07
*DF-NEW                     PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'         ; * DRF20
*DF-NEW                     PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'         ; * DRF07
*DF-NEW                  END                    ; * DRF07
*DF-NEW               END ELSE                  ; * DRF07
*DF-NEW                  WEEK.FLAT.FEE = 0      ; * DRF07
*DF-NEW                  WEEK.PSTG.FEE = 0      ; * DRF07
*DF-NEW                  WEEK.AFSI.FEE = 0      ; * DRF07
*DF-NEW                  WEEK.PULSE.TMS.FEE = 0           ; * DRF07
*DF-NEW                  PER.ANALYTICS.FEE = 0        ; * DRF20
*DF-NEW                  PER.UPS.FEE = 0        ; * DRF07
*DF-NEW               END                       ; * DRF07
*DF-NEW         END CASE                        ; * DRF07
*DF-NEW      END                                ; * DRF07

      IF CLIENT.ID='01592' OR CLIENT.ID='01633' OR CLIENT.ID='01979' OR CLIENT.ID='01485' THEN        ; * JMK28 ; * JMK30 ; * JMK30 ; * NPR03 ; * JMK35 ; * DRF18
         WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'       ; * JMK28
         WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'       ; * JMK28
         WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'       ; * JMK28
         WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'       ; * JMK28
         PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'           ; * DRF20
         PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'           ; * JMK28
         IF SEP.DIV+0=0 THEN             ; * JMK28
            DIV.ARRAY=''                 ; * JMK28
            NDVAL=DCOUNT(DIV.LIST<1>,@VM)          ; * JMK28
            FOR DVAL=1 TO NDVAL          ; * JMK28
               IF DIV.LIST<2,DVAL>#'' THEN         ; * JMK28
                  DIV.ARRAY<1,-1>=DIV.LIST<1,DVAL>           ; * JMK28
               END                       ; * JMK28
            NEXT DVAL                    ; * JMK28
            @USER0=DIV.ARRAY             ; * JMK28
         END ELSE                        ; * JMK28

            DIV.ARRAY=REG.DIV.ARRAY<1>   ; * JMK37
            IF DIV.REG='R' THEN          ; * JMK37
               DIV.ARRAY=REG.DIV.ARRAY<3>          ; * JMK37
            END                          ; * JMK37
            DIV.CODE.COUNT=DCOUNT(DIV.ARRAY<1>,@VM)          ; * JMK28
            LOOP.CNT=DIV.CODE.COUNT      ; * JMK37
            IF DIV.REG='R' THEN          ; * JMK37
               DIV.CODE.COUNT=DCOUNT(REG.DIV.ARRAY<1>,@VM)   ; * JMK37
            END                          ; * JMK37
            LOCATE DIV.CODE[1,5] IN DIV.ARRAY<1> SETTING DPOS THEN     ; * JMK28

               IF DPOS=LOOP.CNT THEN     ; * JMK28 ; * JMK137
                  WEEK.FLAT.AMT = WEEK.FLAT.FEE    ; * JMK28
                  WEEK.PSTG.AMT = WEEK.PSTG.FEE    ; * JMK28
                  WEEK.AFSI.AMT = WEEK.AFSI.FEE    ; * JMK28
                  WEEK.PULSE.TMS.AMT = WEEK.PULSE.TMS.FEE    ; * JMK28
                  PER.ANALYTICS.AMT = PER.ANALYTICS.FEE        ; * DRF20
                  PER.UPS.AMT = PER.UPS.FEE        ; * JMK28

                  FOR VAL=1 TO LOOP.CNT-1          ; * JMK28 ; * JMK37

                     IF DIV.REG='R' THEN           ; * JMK37
                        REG.DIV.COUNT=DCOUNT(REG.DIV.ARRAY<5,VAL>,@SVM)
                        WEEK.FLAT.FEE = WEEK.FLAT.FEE-(WEEK.FLAT.AMT/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'         ; * JMK28 ; * JMK37
                        WEEK.PSTG.FEE = WEEK.PSTG.FEE-(WEEK.PSTG.AMT/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'         ; * JMK28 ; * JMK37
                        WEEK.AFSI.FEE = WEEK.AFSI.FEE-(WEEK.AFSI.AMT/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'         ; * JMK28 ; * JMK37
                        WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.FEE-(WEEK.PULSE.TMS.AMT/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'    ; * JMK28 ; * JMK37
                        PER.ANALYTICS.FEE = PER.ANALYTICS.FEE-(PER.ANALYTICS.AMT/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'     ; * DRF20 
                        PER.UPS.FEE = PER.UPS.FEE-(PER.UPS.AMT/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'     ; * JMK28 ; * JMK37
                     END ELSE            ; * JMK37 ELSE
                        WEEK.FLAT.FEE = WEEK.FLAT.FEE-(WEEK.FLAT.AMT/DIV.CODE.COUNT)'R0'   ; * JMK28 ; * JMK37
                        WEEK.PSTG.FEE = WEEK.PSTG.FEE-(WEEK.PSTG.AMT/DIV.CODE.COUNT)'R0'   ; * JMK28 ; * JMK37
                        WEEK.AFSI.FEE = WEEK.AFSI.FEE-(WEEK.AFSI.AMT/DIV.CODE.COUNT)'R0'   ; * JMK28 ; * JMK37
                        WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.FEE-(WEEK.PULSE.TMS.AMT/DIV.CODE.COUNT)'R0'        ; * JMK28 ; * JMK37
                        PER.ANALYTICS.FEE = PER.ANALYTICS.FEE-(PER.ANALYTICS.AMT/DIV.CODE.COUNT)'R0'         ; * DRF20 
                        PER.UPS.FEE = PER.UPS.FEE-(PER.UPS.AMT/DIV.CODE.COUNT)'R0'         ; * JMK28 ; * JMK37
                     END                 ; * JMK37
                  NEXT VAL               ; * JMK28
               END ELSE                  ; * JMK28
                  IF DIV.REG='R' THEN    ; * JMK37
                     REG.DIV.COUNT=DCOUNT(REG.DIV.ARRAY<5,DPOS>,@SVM)  ; * JMK37
                     WEEK.FLAT.FEE = (WEEK.FLAT.RATE/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'     ; * JMK28 ; * NPR03
                     WEEK.PSTG.FEE = (WEEK.PSTG.RATE/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'     ; * JMK28 ; * NPR03

                     WEEK.AFSI.FEE = (WEEK.AFSI.RATE/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'     ; * JMK28 ; * NPR03
                     WEEK.PULSE.TMS.FEE = (WEEK.PULSE.TMS.RATE/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'     ; * JMK28 ; * NPR03
                     PER.ANALYTICS.FEE = (PER.ANALYTICS.RATE/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'         ; * DRF20 
                     PER.UPS.FEE = (PER.UPS.RATE/DIV.CODE.COUNT*REG.DIV.COUNT)'R0'         ; * JMK28 ; * NPR03
                  END ELSE               ; * JMK37 ELSE
                     WEEK.FLAT.FEE = (WEEK.FLAT.RATE/DIV.CODE.COUNT)'R0'         ; * JMK28 ; * NPR03
                     WEEK.PSTG.FEE = (WEEK.PSTG.RATE/DIV.CODE.COUNT)'R0'         ; * JMK28 ; * NPR03

                     WEEK.AFSI.FEE = (WEEK.AFSI.RATE/DIV.CODE.COUNT)'R0'         ; * JMK28 ; * NPR03
                     WEEK.PULSE.TMS.FEE = (WEEK.PULSE.TMS.RATE/DIV.CODE.COUNT)'R0'         ; * JMK28 ; * NPR03
                     PER.ANALYTICS.FEE = (PER.ANALYTICS.RATE/DIV.CODE.COUNT)'R0'   ; * DRF20 
                     PER.UPS.FEE = (PER.UPS.RATE/DIV.CODE.COUNT)'R0'   ; * JMK28 ; * NPR03
                  END                    ; * JMK37
               END                       ; * JMK28
               IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN       ; * JMK28
                  DTL.DESC='Flat Fee for each active division'         ; * JMK28
                  DTL.QTY=1              ; * JMK28
                  DTL.RATE=WEEK.FLAT.RATE/7*DAYS/DIV.CODE.COUNT        ; * JMK28
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK28
                  WEEK.FLAT.DTL=DTL.LINE           ; * JMK28
               END                       ; * JMK28
               IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN       ; * JMK28
                  DTL.DESC='Flat Process & Handling Fee for each active division'          ; * JMK28
                  DTL.QTY=1              ; * JMK28
                  DTL.RATE=WEEK.PSTG.RATE/7*DAYS/DIV.CODE.COUNT        ; * JMK28
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK28
                  WEEK.PSTG.DTL=DTL.LINE           ; * JMK28
               END                       ; * JMK28
               IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN       ; * JMK28
                  DTL.DESC='Flat AFSi Fee for each active division'    ; * JMK28
                  DTL.QTY=1              ; * JMK28
                  DTL.RATE=WEEK.AFSI.RATE/7*DAYS/DIV.CODE.COUNT        ; * JMK28
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK28
                  WEEK.AFSI.DTL=DTL.LINE           ; * JMK28
               END                       ; * JMK28
               IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN  ; * JMK28
                  DTL.DESC='Flat PulseTMS Fee for each active division'          ; * JMK28
                  DTL.QTY=1              ; * JMK28
                  DTL.RATE=WEEK.PULSE.TMS.RATE/7*DAYS/DIV.CODE.COUNT   ; * JMK28
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK28
                  WEEK.PULSE.TMS.DTL=DTL.LINE      ; * JMK28
               END                       ; * JMK28
               IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN         ; * DRF20
                  DTL.DESC='Flat Analytics Fee for each active division'       ; * DRF20
                  DTL.QTY=1              ; * DRF20
                  DTL.RATE=PER.ANALYTICS.RATE/7*DAYS/DIV.CODE.COUNT          ; * DRF20
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * DRF20
                  PER.ANALYTICS.DTL=DTL.LINE   ; * DRF20
               END                       ; * DRF20
               IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN         ; * JMK28
                  DTL.DESC='Flat UPS Service Fee for each active division'       ; * JMK28
                  DTL.QTY=1              ; * JMK28
                  DTL.RATE=PER.UPS.RATE/7*DAYS/DIV.CODE.COUNT          ; * JMK28
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK28
                  PER.UPS.DTL=DTL.LINE   ; * JMK28
               END                       ; * JMK28
            END ELSE                     ; * JMK28
               WEEK.FLAT.FEE = 0         ; * JMK28
               WEEK.PSTG.FEE = 0         ; * JMK28
               WEEK.AFSI.FEE = 0         ; * JMK28
               WEEK.PULSE.TMS.FEE = 0    ; * JMK28
               PER.ANALYTICS.FEE = 0           ; * DRF20
               PER.UPS.FEE = 0           ; * JMK28
               WEEK.FLAT.DTL=''          ; * JMK17
               WEEK.PSTG.DTL=''          ; * JMK17
               WEEK.AFSI.DTL=''          ; * JMK17
               WEEK.PULSE.TMS.DTL=''     ; * JMK17
               PER.ANALYTICS.DTL=''            ; * DRF20
               PER.UPS.DTL=''            ; * JMK17
            END                          ; * JMK28
         END                             ; * JMK28
      END                                ; * JMK28


      IF CLIENT.ID='02084' AND SEP.DIV+0#0 THEN    ; * JMK40 ; Assign all of the weekly prorated fees to one division (00004)
         IF DIV.CODE[1,5]='00015' THEN   ; * JMK40 ; * DRF11
            IF DAYS=7 THEN               ; * JMK40
               WEEK.FLAT.FEE = WEEK.FLAT.RATE      ; * JMK40
               WEEK.PSTG.FEE = WEEK.PSTG.RATE      ; * JMK40
               WEEK.AFSI.FEE = WEEK.AFSI.RATE      ; * JMK40
               WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE      ; * JMK40
               PER.ANALYTICS.FEE = PER.ANALYTICS.RATE          ; * DRF20
               PER.UPS.FEE = PER.UPS.RATE          ; * JMK40
            END ELSE                     ; * JMK40
               WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'           ; * JMK40
               WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'           ; * JMK40
               WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'           ; * JMK40
               WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'           ; * JMK40
               PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'     ; * DRF20
               PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'     ; * JMK40
            END                          ; * JMK40
         END ELSE                        ; * JMK40
            WEEK.FLAT.FEE = 0            ; * JMK40
            WEEK.PSTG.FEE = 0            ; * JMK40
            WEEK.AFSI.FEE = 0            ; * JMK40
            WEEK.PULSE.TMS.FEE = 0       ; * JMK40
            PER.ANALYTICS.FEE = 0              ; * DRF20
            PER.UPS.FEE = 0              ; * JMK40
         END                             ; * JMK40
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * JMK40
            IF DAYS=7 THEN               ; * JMK40
               DTL.DESC='Flat Fee for each division'         ; * JMK40
               DTL.QTY=1                 ; * JMK40
               DTL.RATE=WEEK.FLAT.RATE   ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.FLAT.DTL=DTL.LINE    ; * JMK40
            END ELSE                     ; * JMK40
               DTL.DESC='Flat Fee for ':DAYS:' days'         ; * JMK40
               DTL.QTY=DAYS              ; * JMK40
               DTL.RATE=WEEK.FLAT.RATE/7           ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.FLAT.DTL=DTL.LINE    ; * JMK40
            END                          ; * JMK40
         END                             ; * JMK40
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * JMK40
            IF DAYS=7 THEN               ; * JMK40
               DTL.DESC='Flat Process & Handling Fee for each division'          ; * JMK40
               DTL.QTY=1                 ; * JMK40
               DTL.RATE=WEEK.PSTG.RATE   ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.PSTG.DTL=DTL.LINE    ; * JMK40
            END ELSE                     ; * JMK40
               DTL.DESC='Flat Process & Handling Fee for ':DAYS:' days'          ; * JMK40
               DTL.QTY=DAYS              ; * JMK40
               DTL.RATE=WEEK.PSTG.RATE/7           ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.PSTG.DTL=DTL.LINE    ; * JMK40
            END                          ; * JMK40
         END                             ; * JMK40
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * JMK40
            IF DAYS=7 THEN               ; * JMK40
               DTL.DESC='Flat AFSi Fee for each division'    ; * JMK40
               DTL.QTY=1                 ; * JMK40
               DTL.RATE=WEEK.AFSI.RATE   ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.AFSI.DTL=DTL.LINE    ; * JMK40
            END ELSE                     ; * JMK40
               DTL.DESC='Flat AFSi Fee for ':DAYS:' days'    ; * JMK40
               DTL.QTY=DAYS              ; * JMK40
               DTL.RATE=WEEK.AFSI.RATE/7           ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.AFSI.DTL=DTL.LINE    ; * JMK40
            END                          ; * JMK40
         END                             ; * JMK40
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * JMK40
            IF DAYS=7 THEN               ; * JMK40
               DTL.DESC='Flat PulseTMS Fee for each division'          ; * JMK40
               DTL.QTY=1                 ; * JMK40
               DTL.RATE=WEEK.PULSE.TMS.RATE        ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * JMK40
            END ELSE                     ; * JMK40
               DTL.DESC='Flat PulseTMS Fee for ':DAYS:' days'          ; * JMK40
               DTL.QTY=DAYS              ; * JMK40
               DTL.RATE=WEEK.PULSE.TMS.RATE/7      ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * JMK40
            END                          ; * JMK40
         END                             ; * JMK40
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN     ; * DRF20
            IF DAYS=7 THEN               ; * DRF20
               DTL.DESC='Flat Analytics Fee for each division'       ; * DRF20
               DTL.QTY=1                 ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE     ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE      ; * DRF20
            END ELSE                     ; * DRF20
               DTL.DESC='Flat Analytics Fee for ':DAYS:' days'       ; * DRF20
               DTL.QTY=DAYS              ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE/7   ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE      ; * DRF20
            END                          ; * DRF20
         END                             ; * DRF20
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * JMK40
            IF DAYS=7 THEN               ; * JMK40
               DTL.DESC='Flat UPS Service Fee for each division'       ; * JMK40
               DTL.QTY=1                 ; * JMK40
               DTL.RATE=PER.UPS.RATE     ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               PER.UPS.DTL=DTL.LINE      ; * JMK40
            END ELSE                     ; * JMK40
               DTL.DESC='Flat UPS Service Fee for ':DAYS:' days'       ; * JMK40
               DTL.QTY=DAYS              ; * JMK40
               DTL.RATE=PER.UPS.RATE/7   ; * JMK40
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * JMK40
               PER.UPS.DTL=DTL.LINE      ; * JMK40
            END                          ; * JMK40
         END                             ; * JMK40
      END                                ; * JMK40
      IF CLIENT.ID='01256' AND SEP.DIV+0#0 THEN    ; * DRF19 ; Assign all of the weekly prorated fees to one division (00001)
         IF DIV.CODE[1,5]='00001' THEN   ; * DRF19 ; * DRF11
            IF DAYS=7 THEN               ; * DRF19
               WEEK.FLAT.FEE = WEEK.FLAT.RATE      ; * DRF19
               WEEK.PSTG.FEE = WEEK.PSTG.RATE      ; * DRF19
               WEEK.AFSI.FEE = WEEK.AFSI.RATE      ; * DRF19
               WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE      ; * DRF19
               PER.ANALYTICS.FEE = PER.ANALYTICS.RATE          ; * DRF20
               PER.UPS.FEE = PER.UPS.RATE          ; * DRF19
            END ELSE                     ; * DRF19
               WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'           ; * DRF19
               WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'           ; * DRF19
               WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'           ; * DRF19
               WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'           ; * DRF19
               PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'     ; * DRF20
               PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'     ; * DRF19
            END                          ; * DRF19
         END ELSE                        ; * DRF19
            WEEK.FLAT.FEE = 0            ; * DRF19
            WEEK.PSTG.FEE = 0            ; * DRF19
            WEEK.AFSI.FEE = 0            ; * DRF19
            WEEK.PULSE.TMS.FEE = 0       ; * DRF19
            PER.ANALYTICS.FEE = 0              ; * DRF20
            PER.UPS.FEE = 0              ; * DRF19
         END                             ; * DRF19
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * DRF19
            IF DAYS=7 THEN               ; * DRF19
               DTL.DESC='Flat Fee for each division'         ; * DRF19
               DTL.QTY=1                 ; * DRF19
               DTL.RATE=WEEK.FLAT.RATE   ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.FLAT.DTL=DTL.LINE    ; * DRF19
            END ELSE                     ; * DRF19
               DTL.DESC='Flat Fee for ':DAYS:' days'         ; * DRF19
               DTL.QTY=DAYS              ; * DRF19
               DTL.RATE=WEEK.FLAT.RATE/7           ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.FLAT.DTL=DTL.LINE    ; * DRF19
            END                          ; * DRF19
         END                             ; * DRF19
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * DRF19
            IF DAYS=7 THEN               ; * DRF19
               DTL.DESC='Flat Process & Handling Fee for each division'          ; * DRF19
               DTL.QTY=1                 ; * DRF19
               DTL.RATE=WEEK.PSTG.RATE   ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.PSTG.DTL=DTL.LINE    ; * DRF19
            END ELSE                     ; * DRF19
               DTL.DESC='Flat Process & Handling Fee for ':DAYS:' days'          ; * DRF19
               DTL.QTY=DAYS              ; * DRF19
               DTL.RATE=WEEK.PSTG.RATE/7           ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.PSTG.DTL=DTL.LINE    ; * DRF19
            END                          ; * DRF19
         END                             ; * DRF19
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * DRF19
            IF DAYS=7 THEN               ; * DRF19
               DTL.DESC='Flat AFSi Fee for each division'    ; * DRF19
               DTL.QTY=1                 ; * DRF19
               DTL.RATE=WEEK.AFSI.RATE   ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.AFSI.DTL=DTL.LINE    ; * DRF19
            END ELSE                     ; * DRF19
               DTL.DESC='Flat AFSi Fee for ':DAYS:' days'    ; * DRF19
               DTL.QTY=DAYS              ; * DRF19
               DTL.RATE=WEEK.AFSI.RATE/7           ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.AFSI.DTL=DTL.LINE    ; * DRF19
            END                          ; * DRF19
         END                             ; * DRF19
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * DRF19
            IF DAYS=7 THEN               ; * DRF19
               DTL.DESC='Flat PulseTMS Fee for each division'          ; * DRF19
               DTL.QTY=1                 ; * DRF19
               DTL.RATE=WEEK.PULSE.TMS.RATE        ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRF19
            END ELSE                     ; * DRF19
               DTL.DESC='Flat PulseTMS Fee for ':DAYS:' days'          ; * DRF19
               DTL.QTY=DAYS              ; * DRF19
               DTL.RATE=WEEK.PULSE.TMS.RATE/7      ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRF19
            END                          ; * DRF19
         END                             ; * DRF19
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN     ; * DRF20
            IF DAYS=7 THEN               ; * DRF20
               DTL.DESC='Flat Analytics Fee for each division'       ; * DRF20
               DTL.QTY=1                 ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE     ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE      ; * DRF20
            END ELSE                     ; * DRF20
               DTL.DESC='Flat Analytics Fee for ':DAYS:' days'       ; * DRF20
               DTL.QTY=DAYS              ; * DRF20
               DTL.RATE=PER.ANALYTICS.RATE/7   ; * DRF20
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF20
               PER.ANALYTICS.DTL=DTL.LINE      ; * DRF20
            END                          ; * DRF20
         END                             ; * DRF20
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * DRF19
            IF DAYS=7 THEN               ; * DRF19
               DTL.DESC='Flat UPS Service Fee for each division'       ; * DRF19
               DTL.QTY=1                 ; * DRF19
               DTL.RATE=PER.UPS.RATE     ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               PER.UPS.DTL=DTL.LINE      ; * DRF19
            END ELSE                     ; * DRF19
               DTL.DESC='Flat UPS Service Fee for ':DAYS:' days'       ; * DRF19
               DTL.QTY=DAYS              ; * DRF19
               DTL.RATE=PER.UPS.RATE/7   ; * DRF19
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF19
               PER.UPS.DTL=DTL.LINE      ; * DRF19
            END                          ; * DRF19
         END                             ; * DRF19
      END                                ; * DRF19
      IF CLIENT.ID='06024' AND SEP.DIV+0#0 THEN    ; * DRF21 ; Assign all of the weekly prorated fees to one division (00001)
         IF DIV.CODE[1,5]='00001' THEN   ; * DRF21 ; * DRF11
            IF DAYS=7 THEN               ; * DRF21
               WEEK.FLAT.FEE = WEEK.FLAT.RATE      ; * DRF21
               WEEK.PSTG.FEE = WEEK.PSTG.RATE      ; * DRF21
               WEEK.AFSI.FEE = WEEK.AFSI.RATE      ; * DRF21
               WEEK.PULSE.TMS.FEE = WEEK.PULSE.TMS.RATE      ; * DRF21
               PER.ANALYTICS.FEE = PER.ANALYTICS.RATE          ; * DRF21
               PER.UPS.FEE = PER.UPS.RATE          ; * DRF21
            END ELSE                     ; * DRF21
               WEEK.FLAT.FEE = ((WEEK.FLAT.RATE/7)*DAYS)'R0'           ; * DRF21
               WEEK.PSTG.FEE = ((WEEK.PSTG.RATE/7)*DAYS)'R0'           ; * DRF21
               WEEK.AFSI.FEE = ((WEEK.AFSI.RATE/7)*DAYS)'R0'           ; * DRF21
               WEEK.PULSE.TMS.FEE = ((WEEK.PULSE.TMS.RATE/7)*DAYS)'R0'           ; * DRF21
               PER.ANALYTICS.FEE = ((PER.ANALYTICS.RATE/7)*DAYS)'R0'     ; * DRF21
               PER.UPS.FEE = ((PER.UPS.RATE/7)*DAYS)'R0'     ; * DRF21
            END                          ; * DRF21
         END ELSE                        ; * DRF21
            WEEK.FLAT.FEE = 0            ; * DRF21
            WEEK.PSTG.FEE = 0            ; * DRF21
            WEEK.AFSI.FEE = 0            ; * DRF21
            WEEK.PULSE.TMS.FEE = 0       ; * DRF21
            PER.ANALYTICS.FEE = 0              ; * DRF21
            PER.UPS.FEE = 0              ; * DRF21
         END                             ; * DRF21
         IF BUILD.DTL AND WEEK.FLAT.FEE+0#0 THEN   ; * DRF21
            IF DAYS=7 THEN               ; * DRF21
               DTL.DESC='Flat Fee for each division'         ; * DRF21
               DTL.QTY=1                 ; * DRF21
               DTL.RATE=WEEK.FLAT.RATE   ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.FLAT.DTL=DTL.LINE    ; * DRF21
            END ELSE                     ; * DRF21
               DTL.DESC='Flat Fee for ':DAYS:' days'         ; * DRF21
               DTL.QTY=DAYS              ; * DRF21
               DTL.RATE=WEEK.FLAT.RATE/7           ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.FLAT.DTL=DTL.LINE    ; * DRF21
            END                          ; * DRF21
         END                             ; * DRF21
         IF BUILD.DTL AND WEEK.PSTG.FEE+0#0 THEN   ; * DRF21
            IF DAYS=7 THEN               ; * DRF21
               DTL.DESC='Flat Process & Handling Fee for each division'          ; * DRF21
               DTL.QTY=1                 ; * DRF21
               DTL.RATE=WEEK.PSTG.RATE   ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.PSTG.DTL=DTL.LINE    ; * DRF21
            END ELSE                     ; * DRF21
               DTL.DESC='Flat Process & Handling Fee for ':DAYS:' days'          ; * DRF21
               DTL.QTY=DAYS              ; * DRF21
               DTL.RATE=WEEK.PSTG.RATE/7           ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.PSTG.DTL=DTL.LINE    ; * DRF21
            END                          ; * DRF21
         END                             ; * DRF21
         IF BUILD.DTL AND WEEK.AFSI.FEE+0#0 THEN   ; * DRF21
            IF DAYS=7 THEN               ; * DRF21
               DTL.DESC='Flat AFSi Fee for each division'    ; * DRF21
               DTL.QTY=1                 ; * DRF21
               DTL.RATE=WEEK.AFSI.RATE   ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.AFSI.DTL=DTL.LINE    ; * DRF21
            END ELSE                     ; * DRF21
               DTL.DESC='Flat AFSi Fee for ':DAYS:' days'    ; * DRF21
               DTL.QTY=DAYS              ; * DRF21
               DTL.RATE=WEEK.AFSI.RATE/7           ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.AFSI.DTL=DTL.LINE    ; * DRF21
            END                          ; * DRF21
         END                             ; * DRF21
         IF BUILD.DTL AND WEEK.PULSE.TMS.FEE+0#0 THEN        ; * DRF21
            IF DAYS=7 THEN               ; * DRF21
               DTL.DESC='Flat PulseTMS Fee for each division'          ; * DRF21
               DTL.QTY=1                 ; * DRF21
               DTL.RATE=WEEK.PULSE.TMS.RATE        ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRF21
            END ELSE                     ; * DRF21
               DTL.DESC='Flat PulseTMS Fee for ':DAYS:' days'          ; * DRF21
               DTL.QTY=DAYS              ; * DRF21
               DTL.RATE=WEEK.PULSE.TMS.RATE/7      ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               WEEK.PULSE.TMS.DTL=DTL.LINE         ; * DRF21
            END                          ; * DRF21
         END                             ; * DRF21
         IF BUILD.DTL AND PER.ANALYTICS.FEE+0#0 THEN     ; * DRF21
            IF DAYS=7 THEN               ; * DRF21
               DTL.DESC='Flat Analytics Fee for each division'       ; * DRF21
               DTL.QTY=1                 ; * DRF21
               DTL.RATE=PER.ANALYTICS.RATE     ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               PER.ANALYTICS.DTL=DTL.LINE      ; * DRF21
            END ELSE                     ; * DRF21
               DTL.DESC='Flat Analytics Fee for ':DAYS:' days'       ; * DRF21
               DTL.QTY=DAYS              ; * DRF21
               DTL.RATE=PER.ANALYTICS.RATE/7   ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               PER.ANALYTICS.DTL=DTL.LINE      ; * DRF21
            END                          ; * DRF21
         END                             ; * DRF21
         IF BUILD.DTL AND PER.UPS.FEE+0#0 THEN     ; * DRF21
            IF DAYS=7 THEN               ; * DRF21
               DTL.DESC='Flat UPS Service Fee for each division'       ; * DRF21
               DTL.QTY=1                 ; * DRF21
               DTL.RATE=PER.UPS.RATE     ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               PER.UPS.DTL=DTL.LINE      ; * DRF21
            END ELSE                     ; * DRF21
               DTL.DESC='Flat UPS Service Fee for ':DAYS:' days'       ; * DRF21
               DTL.QTY=DAYS              ; * DRF21
               DTL.RATE=PER.UPS.RATE/7   ; * DRF21
               DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)        ; * DRF21
               PER.UPS.DTL=DTL.LINE      ; * DRF21
            END                          ; * DRF21
         END                             ; * DRF21
      END                                ; * DRF21

      PROCESS.FEE += WEEK.FLAT.FEE

      PER.SVC.FEE = (((PER.SVC.RATE*12)/365.25)*DAYS)'R0'
      IF BUILD.DTL AND PER.SVC.FEE+0#0 THEN        ; * JMK17
         DTL.DESC='Flat Service Fee'     ; * JMK17
         DTL.QTY=DAYS                    ; * JMK17
         DTL.RATE=(PER.SVC.RATE*12)/365.25         ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         PER.SVC.DTL=DTL.LINE            ; * JMK17
      END                                ; * JMK17
      PER.LOG.FEE = (((PER.LOG.RATE*12)/365.25)*DAYS)'R0'
      IF CLIENT.ID='01700' THEN     ; * DRF17
         PER.LOG.FEE=PER.LOG.FEE-C.CONS.COM     ; * DRF17
         IF PER.LOG.FEE LT "0" THEN PER.LOG.FEE=0     ; * DRF17
      END     ; * DRF17
      IF CLIENT.ID='30041' THEN     ; * DRF16
         BEGIN CASE     ; * DRF16
            CASE DIV.REG='R'             ; * DRF16
               IF DIV.CODE='VOLEX' THEN    ; * DRF16
                  PER.LOG.FEE = (((PER.LOG.RATE*12)/365.25)*DAYS)'R0'
               END ELSE                  ; * DRF16
                  PER.LOG.FEE = 0
               END                       ; * DRF16
            CASE 1    ; * DRF16
               IF DIV.CODE[1,5]='00013' THEN    ; * DRF16
                  PER.LOG.FEE = (((PER.LOG.RATE*12)/365.25)*DAYS)'R0'
               END ELSE    ; * DRF16
                  PER.LOG.FEE = 0
               END    ; * DRF16
         END CASE    ; * DRF16
      END    ; * DRF16

      IF BUILD.DTL AND PER.LOG.FEE+0#0 THEN        ; * JMK17
         DTL.DESC='Flat Logistics Fee'   ; * JMK17
         DTL.QTY=DAYS                    ; * JMK17
         DTL.RATE=(PER.LOG.RATE*12)/365.25         ; * JMK17
         DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)    ; * JMK17
         PER.LOG.DTL=DTL.LINE            ; * JMK17
      END                                ; * JMK17
*
      ALLOC.LOG.MODE=''                  ; * JMK04
      ALLOC.LOG.FEE=''                   ; * JMK04
      ALLOC.LOG.DTL=''                   ; * JMK17

      SUM.TRN.FEE=SUM(PER.TRN.FEE)+0     ; * JMK05
      IF SUM.TRN.FEE#0 THEN              ; * JMK05
         PER.LOG.FEE=0                   ; * JMK05
         NSVAL=DCOUNT(PER.TRN.FEE,@SVM)  ; * JMK05
         FOR SVAL=1 TO NSVAL             ; * JMK05
            TRN.CODE=PER.TRN.CODE<1,1,SVAL>        ; * JMK05
            TRN.RATE=PER.TRN.FEE<1,1,SVAL>         ; * JMK05
            TRN.FEE=(((TRN.RATE*12)/365.25)*DAYS)'R0'        ; * JMK05
            IF TRN.FEE+0#0 THEN          ; * JMK05
               ALLOC.LOG.MODE<1,-1>=TRN.CODE       ; * JMK05
               ALLOC.LOG.FEE<1,-1>=TRN.FEE         ; * JMK05
               PER.LOG.FEE+=TRN.FEE      ; * JMK05
               IF BUILD.DTL AND SUM(ALLOC.LOG.FEE)#0 THEN    ; * JMK17
                  DTL.DESC='Flat Logistics Fee allocated by transport method ':TRN.CODE    ; * JMK17
                  DTL.QTY=DAYS           ; * JMK17
                  DTL.RATE=(TRN.RATE*12)/365.25    ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  ALLOC.LOG.DTL<1,-1>=DTL.LINE     ; * JMK17
               END                       ; * JMK17
            END                          ; * JMK05
         NEXT SVAL                       ; * JMK05
         IF SEP.DIV+0#0 THEN             ; * NPR01

            IF CLIENT.ID = '01128' OR CLIENT.ID = '01499' OR CLIENT.ID='01682' THEN        ; *NPR02 ; * JMK38
               NULL                      ; * NPR02
            END ELSE                     ; * NPR02
               ALLOC.LOG.MODE=''         ; * NPR01
               ALLOC.LOG.FEE=''          ; * NPR01
               PER.LOG.FEE=0             ; * NPR01
               ALLOC.LOG.DTL=''          ; * JMK17
            END                          ; * NPR02
         END                             ; * NPR01
      END                                ; * JMK05
      SUM.CAR.FEE=SUM(PER.CAR.FEE)+0     ; * JMK14
      IF SUM.CAR.FEE#0 THEN              ; * JMK14
         PER.LOG.FEE=0                   ; * JMK14
         NSVAL=DCOUNT(PER.CAR.FEE,@SVM)  ; * JMK14
         FOR SVAL=1 TO NSVAL             ; * JMK14
            CAR.CODE=PER.CAR.CODE<1,1,SVAL>        ; * JMK14
            CAR.RATE=PER.CAR.FEE<1,1,SVAL>         ; * JMK14
            CAR.FEE=(((CAR.RATE*12)/365.25)*DAYS)'R0'        ; * JMK14
            IF CAR.FEE+0#0 THEN          ; * JMK14
               ALLOC.LOG.MODE<1,-1>=CAR.CODE       ; * JMK14
               ALLOC.LOG.FEE<1,-1>=CAR.FEE         ; * JMK14
               PER.LOG.FEE+=CAR.FEE      ; * JMK14
               IF BUILD.DTL AND ALLOC.LOG.FEE+0#0 THEN       ; * JMK17
                  DTL.DESC='Flat Logistics Fee allocated by Carrier ':CAR.CODE   ; * JMK17
                  DTL.QTY=DAYS           ; * JMK17
                  DTL.RATE=(CAR.RATE*12)/365.25    ; * JMK17
                  DTL.LINE=DTL.DESC:@SVM:DTL.QTY:@SVM:DTL.RATE:@SVM:(DTL.QTY*DTL.RATE)     ; * JMK17
                  ALLOC.LOG.DTL<1,-1>=DTL.LINE     ; * JMK17
               END                       ; * JMK17
            END                          ; * JMK14
         NEXT SVAL                       ; * JMK14
         IF SEP.DIV+0#0 THEN             ; * JMK14

            IF CLIENT.ID = '01128' OR CLIENT.ID = '01499' OR CLIENT.ID = '01682' THEN      ; * JMK14 ; * JMK38
               NULL                      ; * JMK14
            END ELSE                     ; * JMK14
               ALLOC.LOG.MODE=''         ; * JMK14
               ALLOC.LOG.FEE=''          ; * JMK14
               PER.LOG.FEE=0             ; * JMK14
               ALLOC.LOG.DTL=''          ; * JMK17
            END                          ; * JMK14
         END                             ; * JMK14
      END                                ; * JMK14
      IF CLIENT.ID='00761' THEN          ; * JMK11 ; * JMK34

         IF SEP.DIV+0#0 AND DIV.CODE#"00001" THEN  ; * JMK11 ; JMK43
            PER.SVC.FEE = 0              ; * JMK11
            PER.LOG.FEE = 0              ; * JMK11
            ALLOC.LOG.MODE=''            ; * JMK11
            ALLOC.LOG.FEE=''             ; * JMK11
            WEEK.FLAT.FEE = 0            ; * JMK11
            WEEK.PSTG.FEE = 0            ; * JMK11
            WEEK.AFSI.FEE = 0            ; * JMK11
            WEEK.PULSE.TMS.FEE = 0       ; * JMK11
            WEEK.FLAT.DTL=''             ; * JMK17
            WEEK.PSTG.DTL=''             ; * JMK17
            WEEK.AFSI.DTL=''             ; * JMK17
            WEEK.PULSE.TMS.DTL=''        ; * JMK17
         END                             ; * JMK11
      END                                ; * JMK11
      IF CLIENT.ID='01682' THEN          ; * JMK38
         IF SEP.DIV+0#0 AND DIV.CODE#"00001" THEN  ; * JMK38
            PER.SVC.FEE = 0              ; * JMK38
            PER.LOG.FEE = 0              ; * JMK38
            ALLOC.LOG.MODE=''            ; * JMK38
            ALLOC.LOG.FEE=''             ; * JMK38
            WEEK.FLAT.FEE = 0            ; * JMK38
            WEEK.PSTG.FEE = 0            ; * JMK38
            WEEK.AFSI.FEE = 0            ; * JMK38
            WEEK.PULSE.TMS.FEE = 0       ; * JMK38
            WEEK.FLAT.DTL=''             ; * JMK38
            WEEK.PSTG.DTL=''             ; * JMK38
            WEEK.AFSI.DTL=''             ; * JMK38
            WEEK.PULSE.TMS.DTL=''        ; * JMK38
         END                             ; * JMK38
      END                                ; * JMK38
      IF CLIENT.ID='01949' THEN          ; * JMK39
         IF SEP.DIV+0#0 AND DIV.CODE#"00001" AND DIV.CODE#'00002' THEN           ; * JMK39
            PER.SVC.FEE = 0              ; * JMK39
            PER.LOG.FEE = 0              ; * JMK39
            ALLOC.LOG.MODE=''            ; * JMK39
            ALLOC.LOG.FEE=''             ; * JMK39
            WEEK.FLAT.FEE = 0            ; * JMK39
            WEEK.PSTG.FEE = 0            ; * JMK39
            WEEK.AFSI.FEE = 0            ; * JMK39
            WEEK.PULSE.TMS.FEE = 0       ; * JMK39
            WEEK.FLAT.DTL=''             ; * JMK39
            WEEK.PSTG.DTL=''             ; * JMK39
            WEEK.AFSI.DTL=''             ; * JMK39
            WEEK.PULSE.TMS.DTL=''        ; * JMK39
         END                             ; * JMK39
      END                                ; * JMK39
      IF SEP.DIV+0#0 THEN                ; * NPR01

         IF CLIENT.REC<231>='Y' OR CLIENT.ID = '01128' OR CLIENT.ID='01499' OR CLIENT.ID='01584' OR CLIENT.ID='01592' OR CLIENT.ID='01633' OR CLIENT.ID='00937' OR CLIENT.ID='1682' OR CLIENT.ID='01672' OR CLIENT.ID='01468' OR CLIENT.ID='01485' THEN     ; *NPR02 ; * JMK16 ; * JMK19 ; * JMK20 ; * JMK22 ; * JMK25 ; * JMK26 ; * JMK30 ; * JMK31 ; * JMK34 ; * NPR03 ; * JMK35 ; * JMK38 ; * DRF09 ; * DRF18
            NULL                         ; * NPR02
         END ELSE                        ; * NPR02
            PER.SVC.FEE = 0              ; * NPR01
            PER.LOG.FEE = 0              ; * NPR01
            ALLOC.LOG.MODE=''            ; * NPR01
            ALLOC.LOG.FEE=''             ; * NPR01
            WEEK.FLAT.FEE = 0            ; * NPR01
            WEEK.PSTG.FEE = 0            ; * NPR01
            WEEK.AFSI.FEE = 0            ; * NPR01
            WEEK.PULSE.TMS.FEE = 0       ; * NPR01
            WEEK.FLAT.DTL=''             ; * JMK17
            WEEK.PSTG.DTL=''             ; * JMK17
            WEEK.AFSI.DTL=''             ; * JMK17
            WEEK.PULSE.TMS.DTL=''        ; * JMK17
            PER.UPS.FEE=''               ; * DRF13
            PER.ANALYTICS.FEE=''               ; * DRF20
         END                             ; * NPR02
      END                                ; * NPR01
*
* SET RETURN ARGUMENT VARIABLE
*

      VOUT<14>=PROCESS.FEE
      VOUT<15>=PRE.AUDIT.FEE
      VOUT<16>=PROCESS.FEE+PRE.AUDIT.FEE
      VOUT<17>=WEEK.FLAT.FEE
      VOUT<18>=WEEK.PSTG.FEE
      VOUT<19>=WEEK.AFSI.FEE
      VOUT<20>=PER.UPS.FEE
      VOUT<21>=PER.SVC.FEE
      VOUT<22>=PER.LOG.FEE
      VOUT<23>=ALLOC.LOG.MODE            ; * JMK04
      VOUT<24>=ALLOC.LOG.FEE             ; * JMK04
      VOUT<25>=PSTG.DTL                  ; * JMK17
      VOUT<26>=REJECT.PSTG.DTL           ; * JMK17
      VOUT<27>=STC.PSTG.DTL              ; * JMK17
      VOUT<28>=PRE.AUDIT.DTL             ; * JMK17
      VOUT<29>=PPR.BILLS.DTL             ; * JMK17
      VOUT<30>=EDI.LTL.DTL               ; * JMK17
      VOUT<31>=EDI.PARCEL.DTL            ; * JMK17
      VOUT<32>=DUP.DTL                   ; * JMK17
      VOUT<33>=PR.PROCESS.DTL            ; * JMK17
      VOUT<34>=UPS.PROCESS.DTL           ; * JMK17
      VOUT<35>=UPS.TRACK.DTL             ; * JMK17
      VOUT<36>=WEEK.FLAT.DTL             ; * JMK17
      VOUT<37>=WEEK.PSTG.DTL             ; * JMK17
      VOUT<38>=WEEK.AFSI.DTL             ; * JMK17
      VOUT<39>=PER.UPS.DTL               ; * JMK17
      VOUT<40>=PER.SVC.DTL               ; * JMK17
      VOUT<41>=PER.LOG.DTL               ; * JMK17
      VOUT<42>=ALLOC.LOG.DTL             ; * JMK17
      VOUT<43>=WEEK.PULSE.TMS.FEE
      VOUT<44>=WEEK.PULSE.TMS.DTL        ; * JMK17
      VOUT<45>=PER.ANALYTICS.FEE    ; * DRF20
      RETURN
   END
