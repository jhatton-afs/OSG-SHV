* PROGRAM CLIENT LIST FOR ENTRY TO SQL TABLE
*
* AUTHOR: ROB GAUDET
* DATE: APRIL 2, 2002
* MOD April 15th 2002 -- added check for client status.
* THIS PROGRAM IS A PROPRIETARY PRODUCT OF AUTOMATED FREIGHT SYSTEMS
* AND MAY NOT BE USED, COPIED OR MODIFIED WITHOUT THE EXPRESS
* WRITTEN CONSENT OF SAME.
*

    PROG.NAME=''
    PROG.DESC='CLIENT LIST'

	OPEN 'CL.CLIENTS' TO F.CLIENTS ELSE
	END

	METADATA = ""
	METADATA<1,1> = "VARCHAR" ;   METADATA<1,2> = "clientid"  ;			METADATA<1,3>  = 0
	METADATA<2,1> = "VARCHAR" ;   METADATA<2,2> = "name"  ;				METADATA<2,3>  = 0
	METADATA<3,1> = "VARCHAR" ;   METADATA<3,2> = "address"  ;			METADATA<3,3>  = 0
	METADATA<4,1> = "VARCHAR" ;   METADATA<4,2> = "city"  ;				METADATA<4,3>  = 0
	METADATA<5,1> = "VARCHAR" ;   METADATA<5,2> = "state"  ;			METADATA<5,3>  = 0
	METADATA<6,1> = "VARCHAR" ;   METADATA<6,2> = "zip"  ;				METADATA<6,3>  = 0
	METADATA<7,1> = "VARCHAR" ;   METADATA<7,2> = "phone"  ;			METADATA<7,3>  = 0
	METADATA<8,1> = "VARCHAR" ;	  METADATA<8,2> = "fax"  ;			    METADATA<8,3>  = 0
	METADATA<9,1> = "VARCHAR" ;   METADATA<9,2> = "billattn"  ;		    METADATA<9,3>  = 0
	METADATA<10,1>= "VARCHAR" ;  METADATA<10,2> = "contact"  ;		    METADATA<10,3> = 0
	METADATA<11,1>= "VARCHAR" ;  METADATA<11,2> = "status"  ;			METADATA<11,3> = 0
	METADATA<12,1>= "VARCHAR" ;  METADATA<12,2> = "salesrep"  ;			METADATA<12,3> = 0
	METADATA<13,1>= "VARCHAR" ;  METADATA<13,2> = "ExpenseCode"  ;		METADATA<13,3> = 0
	CONVERT @AM TO CHAR(30) IN METADATA
	*PRINT "%METADATA:":METADATA

	CLIENT.LIST = ""

*	STMT = 'SSELECT CL.CLIENTS WITH 30 = "A" AND WITH @ID # "9]" BY 2'
	STMT = 'SSELECT CL.CLIENTS WITH @ID # "9]" BY 2'

	EXECUTE STMT CAPTURING OUTPUT
	NUMUSERS = @SELECTED
	IF NUMUSERS = 0 THEN
	END
	
	ROW = ''
    DONE=0
	LOOP
	UNTIL DONE=1 DO
		READNEXT CLIENT.ID ELSE DONE=1
		IF CLIENT.ID[1,2]='99' THEN GO SKIP.CLIENT
			READ DCLIENTS FROM F.CLIENTS,CLIENT.ID THEN
				ROW<1> 	= CLIENT.ID	    ; * CLIENT NUMBER
				ROW<2> 	= DCLIENTS<2>	; * NAME
				ROW<3> 	= DCLIENTS<3>	; * ADDRESS
				ROW<4> 	= DCLIENTS<4>	; * CITY
				ROW<5> 	= DCLIENTS<5>   ; * STATE
				ROW<6> 	= DCLIENTS<6>   ; * ZIP
				ROW<7> 	= DCLIENTS<31>  ; * PHONE
				ROW<8>  = DCLIENTS<45>  ; * FAX
				ROW<9>  = DCLIENTS<44>  ; * BILLATTN
				ROW<10> = DCLIENTS<46>  ; * CONTACT
				ROW<11> = DCLIENTS<30>  ; * CLIENT STATUS
				ROW<12> = DCLIENTS<130> ; * CURRENT SALESMAN
				ROW<13> = DCLIENTS<13>  ; * DOES CLIENT HAVE EXPENSE CODES
			END
			CONVERT @AM TO CHAR(30) IN ROW
			PRINT ROW
		SKIP.CLIENT:***
	REPEAT
STOP
END
