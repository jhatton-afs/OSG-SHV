* PROGRAM CARRIER LIST FOR ENTRY TO SQL TABLE
*
* AUTHOR: ROB GAUDET
* DATE: APRIL 2, 2002
*
* THIS PROGRAM IS A PROPRIETARY PRODUCT OF AUTOMATED FREIGHT SYSTEMS
* AND MAY NOT BE USED, COPIED OR MODIFIED WITHOUT THE EXPRESS
* WRITTEN CONSENT OF SAME.
*

    PROG.NAME=''
    PROG.DESC='CARRIER LIST'

	OPEN 'CARRIERS' TO F.CARRIER ELSE
	END

	METADATA = ""
	METADATA<1,1> = "VARCHAR" ;   METADATA<1,2> = "carrierid"  ;		METADATA<1,3> = 0
	METADATA<2,1> = "VARCHAR" ;   METADATA<2,2> = "name"  ;				METADATA<2,3> = 0
	METADATA<3,1> = "VARCHAR" ;   METADATA<3,2> = "address"  ;			METADATA<3,3> = 0
	METADATA<4,1> = "VARCHAR" ;   METADATA<4,2> = "city"  ;				METADATA<4,3> = 0
	METADATA<5,1> = "VARCHAR" ;   METADATA<5,2> = "state"  ;			METADATA<5,3> = 0
	METADATA<6,1> = "VARCHAR" ;   METADATA<6,2> = "zip"  ;				METADATA<6,3> = 0
	METADATA<7,1> = "VARCHAR" ;   METADATA<7,2> = "phone"  ;			METADATA<7,3> = 0
	METADATA<8,1> = "VARCHAR" ;   METADATA<8,2> = "country"  ;          METADATA<8,3> = 0
	METADATA<9,1> = "VARCHAR" ;   METADATA<9,2> = "website"  ;          METADATA<9,3> = 0
	METADATA<10,1> = "VARCHAR" ;   METADATA<10,2> = "lastactivitydate"  ;          METADATA<10,3> = 0
	METADATA<11,1> = "VARCHAR" ;   METADATA<11,2> = "w9lastsentdate"  ;          METADATA<11,3> = 0
	CONVERT @AM TO CHAR(30) IN METADATA
	*PRINT "%METADATA:":METADATA

  CARRIER.LIST = ""

	STMT = 'SSELECT CARRIERS BY 1'

	EXECUTE STMT CAPTURING OUTPUT
	NUMFILES = @SELECTED
	IF NUMFILES = 0 THEN
	END
	
	ROW = ''
    DONE=0
	LOOP
	UNTIL DONE=1 DO
		READNEXT CARRIER.ID ELSE DONE=1
			READ DCARRIER FROM F.CARRIER,CARRIER.ID THEN
				ROW<1> = CARRIER.ID			; * CARRIER NUMBER
				ROW<2> = DCARRIER<1>		; * NAME
				ROW<3> = DCARRIER<2>		; * ADDRESS
				ROW<4> = DCARRIER<3>		; * CITY
				ROW<5> = DCARRIER<4>        ; * STATE
				ROW<6> = DCARRIER<5>        ; * ZIP
				ROW<7> = DCARRIER<6>        ; * PHONE
				ROW<8> = DCARRIER<7>		; * COUNTRY
				ROW<9> = DCARRIER<95>		; * WEBSITE
				ROW<10> = DCARRIER<25>'D2/' ; * LAST ACTIVITY DATE
				ROW<11> = DCARRIER<100>'D2/' ; * W9 Sent Date
			END
			CONVERT @AM TO CHAR(30) IN ROW
			PRINT ROW
	REPEAT
STOP
END
