* PROGRAM CLIENT LIST FOR ENTRY TO SQL TABLE
*
* AUTHOR: ROB GAUDET
* DATE: APRIL 2, 2002
* MOD April 15th 2002 -- added check for client status.
* THIS PROGRAM IS A PROPRIETARY PRODUCT OF AUTOMATED FREIGHT SYSTEMS
* AND MAY NOT BE USED, COPIED OR MODIFIED WITHOUT THE EXPRESS
* WRITTEN CONSENT OF SAME.
*

    PROG.NAME=''
    PROG.DESC='CLIENT LIST'

	OPEN 'CLIENTS' TO F.CLIENTS ELSE
	END

	METADATA = ""
	METADATA<1,1> = "VARCHAR" ;   METADATA<1,2> = "clientid"  ;			METADATA<1,3> = 0
	METADATA<2,1> = "VARCHAR" ;   METADATA<2,2> = "name"  ;				METADATA<2,3> = 0
	METADATA<3,1> = "VARCHAR" ;   METADATA<3,2> = "address"  ;			METADATA<3,3> = 0
	METADATA<4,1> = "VARCHAR" ;   METADATA<4,2> = "city"  ;				METADATA<4,3> = 0
	METADATA<5,1> = "VARCHAR" ;   METADATA<5,2> = "state"  ;			METADATA<5,3> = 0
	METADATA<6,1> = "VARCHAR" ;   METADATA<6,2> = "zip"  ;				METADATA<6,3> = 0
	METADATA<7,1> = "VARCHAR" ;   METADATA<7,2> = "phone"  ;			METADATA<7,3> = 0
	METADATA<8,1> = "VARCHAR" ;   METADATA<8,2> = "Iquotepercent"  ;    METADATA<8,3> = 0
	METADATA<9,1> = "VARCHAR" ;   METADATA<9,2> = "Oquotepercent"  ;    METADATA<9,3> = 0
	METADATA<10,1> = "VARCHAR" ;  METADATA<10,2>= "Tquotepercent"  ;	METADATA<10,3> = 0
	METADATA<11,1> = "VARCHAR" ;  METADATA<11,2>= "emailto"  ;			METADATA<11,3> = 0
	METADATA<12,1> = "VARCHAR" ;  METADATA<12,2>= "emailcc"  ;		    METADATA<12,3> = 0
	METADATA<13,1> = "VARCHAR" ;  METADATA<13,2>= "billattn"  ;		    METADATA<13,3> = 0
	METADATA<14,1> = "VARCHAR" ;  METADATA<14,2>= "contact"  ;		    METADATA<14,3> = 0
	METADATA<15,1> = "VARCHAR" ;  METADATA<15,2>= "fax"  ;			    METADATA<15,3> = 0
	METADATA<16,1> = "VARCHAR" ;  METADATA<16,2>= "status"  ;			METADATA<16,3> = 0
	METADATA<17,1> = "VARCHAR" ;  METADATA<17,2>= "salesrep"  ;			METADATA<17,3> = 0
	METADATA<18,1> = "VARCHAR" ;  METADATA<18,2>= "parent_id"  ;		METADATA<18,3> = 0
	METADATA<19,1> = "VARCHAR" ;  METADATA<19,2>= "parent_id"  ;		METADATA<19,3> = 0
	CONVERT @AM TO CHAR(30) IN METADATA
	*PRINT "%METADATA:":METADATA

	CLIENT.LIST = ""

	STMT = 'SSELECT CLIENTS WITH @ID # "9]" BY 2'

	EXECUTE STMT CAPTURING OUTPUT
	NUMUSERS = @SELECTED
	IF NUMUSERS = 0 THEN
	END
	
	ROW = ''
    DONE=0
	LOOP
	UNTIL DONE=1 DO
		READNEXT CLIENT.ID ELSE DONE=1
		IF CLIENT.ID[1,2]='99' THEN GO SKIP.CLIENT
			READ DCLIENTS FROM F.CLIENTS,CLIENT.ID THEN
				ROW<1> 	= CLIENT.ID	; * CLIENT NUMBER
				ROW<2> 	= DCLIENTS<2>	; * NAME
				ROW<3> 	= DCLIENTS<3>	; * ADDRESS
				ROW<4> 	= DCLIENTS<4>	; * CITY
				ROW<5> 	= DCLIENTS<5>   ; * STATE
				ROW<6> 	= DCLIENTS<6>   ; * ZIP
				ROW<7> 	= DCLIENTS<31>  ; * PHONE
				ROW<15> = DCLIENTS<45>  ; * FAX
				ROW<11> = DCLIENTS<125> ; * EMAILTO
				ROW<12> = DCLIENTS<126> ; * EMAILCC
				ROW<13> = DCLIENTS<44>  ; * BILLATTN
				ROW<14> = DCLIENTS<46>  ; * CONTACT
				ROW<8> 	= DCLIENTS<136> ; * INBOUND QUOTE %
				ROW<9> 	= DCLIENTS<137> ; * OUTBOUND QUOTE %
				ROW<10> = DCLIENTS<138> ; * THIRD PARTY QUOTE %
				ROW<16> = DCLIENTS<30>  ; * CLIENT STATUS
				ROW<17> = DCLIENTS<115> ; * CURRENT SALESMAN
				ROW<18> = DCLIENTS<147> ; * PARENT ID
				ROW<19> = DCLIENTS<13> ; * DOES CLIENT HAVE EXPENSE CODES
			END
			CONVERT @AM TO CHAR(30) IN ROW
			PRINT ROW
		SKIP.CLIENT:***
	REPEAT
STOP
END
