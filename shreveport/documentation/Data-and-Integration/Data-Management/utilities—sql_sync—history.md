# SQL Sync History Utilities Of AFS Shreveport

The AFS Shreveport System is a comprehensive freight management platform that handles billing, logistics operations, and client data management. This sub-project implements database synchronization tracking and history management between the MultiValue database system and SQL databases. SQL Sync History Utilities provides critical data integration capabilities to the AFS Shreveport program:

- Historical record keeping of synchronization operations
- Audit trail for data movement between database systems
- Error tracking and notification for failed synchronization attempts
- Performance metrics collection for database operations

## Identified Design Elements

1. **MultiValue to SQL Data Bridge**: Specialized routines that translate between MultiValue data structures and relational SQL tables
2. **Synchronization Logging**: Comprehensive tracking of all data movement operations with timestamps and status codes
3. **Error Management**: Sophisticated retry logic with progressive backoff and notification systems
4. **ODBC Connection Management**: Handles connections to both production and development SQL environments with appropriate failover
5. **Parameterized SQL Execution**: Secure execution of stored procedures with proper parameter binding to prevent SQL injection

## Overview
The architecture follows a robust integration pattern focused on reliability and auditability. The system maintains detailed logs of all synchronization activities, enabling troubleshooting and performance analysis. The retry mechanism ensures resilience against temporary network or database issues, while the notification system alerts administrators to persistent problems. The code is structured to handle various data types from the freight management system, particularly payment information, and maintains data integrity across the disparate database systems.

## Business Functions

### SQL Synchronization Utilities
- `UPD.SQL.CHECK.DELETE.txt` : Subroutine that updates SQL database with payment information from freight bills processed by auditors

## Files
### UPD.SQL.CHECK.DELETE.txt

UPD.SQL.PYMT.SUB is a subroutine that synchronizes freight bill payment data between the MultiValue system and SQL database. It extracts payment information from freight bills including check numbers, amounts, commission details, variances, and balances due, then updates the SQL database through stored procedures. The code establishes an ODBC connection to either production or development SQL servers, prepares and executes SQL statements with parameters, and handles errors by retrying operations and sending email notifications after multiple failures. Key functionality includes payment data extraction, SQL connection management, and error handling with retry logic.

 **Code Landmarks**
- `Line 72`: Creates a unique SQL key by concatenating client ID, carrier ID, PRO number, and process date components
- `Line 186`: Server selection logic that chooses between production and development SQL servers based on the current environment
- `Line 213`: Uses SQL parameter markers with stored procedure calls for efficient data loading
- `Line 122`: Implements error retry logic with email notification after three failed attempts

[Generated by the Sage AI expert workbench: 2025-05-28 08:06:13  https://sage-tech.ai/workbench]: #