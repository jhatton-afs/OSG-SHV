$OPTIONS EXEC.EQ.PERF
$OPTIONS INFO.ABORT
      SUBROUTINE FB.4.2.ZIP(F.CITY,F.ZIPS,CITY,STATE,ZIP)
$OPTIONS HEADER.EJECT
ERRMSG=''
* SUBROUTINE TO FIND ZIP CODE RELATED TO CITY AND STATE
*
      SPACE.COUNT=DCOUNT(CITY,' ')
      FOR I=1 TO SPACE.COUNT
        X=SOUNDEX(FIELD(CITY,' ',I))
        READ ITEM.LIST FROM F.CITY,X ELSE GOTO 150
        Y=DCOUNT(ITEM.LIST,CHAR(254))
        FOR POS=1 TO Y STEP 1
          ID=ITEM.LIST<POS>
          READ REC FROM F.ZIPS,ID ELSE GOTO 100
          TEMP.CITY=OCONV(CITY,'MCU')
          IF OCONV(REC<1>,'MCU')=TEMP.CITY & OCONV(REC<2>,'MCU')=OCONV(STATE,'MCU') THEN
            ZIP=ID
            RETURN
          END
100     NEXT POS
150   NEXT I
      ZIP='00000'
      RETURN
