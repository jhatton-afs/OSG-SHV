$OPTIONS HEADER.EJECT
ERRMSG=''
*
$OPTIONS EXEC.EQ.PERF
$OPTIONS INFO.ABORT
*
* PROGRAM: FB.4.3
* PROGRAM TO DELETE DATA FROM OLD FILE
*
      OPEN '','RFRTH' TO F.RFRTH ELSE ABORT
      OPEN '','RFRTD' TO F.RFRTD ELSE ABORT
      OPEN '','CHECKS' TO F.CHECKS ELSE ABORT
*
      CALL AFS.SCR.HEAD(CO.ID,FILE.ID,'',"FB.4.3","Delete Data From Old System","Freight Billing",CO.NAME,TIME.DATE,1)
*
* ENTER CLIENT ID
*
      HELP="Enter number of client to process. ''=Exit."
      CALL GEN.IN(0,3,'Enter Client Number     #####','',CLIENT.ID,0,5,'R','0',1,-5,3,0,QI,HELP,0,23)
      QI=OCONV(QI,'MCU')
      IF QI='EX' ! QI='X' ! QI='' THEN STOP
      EXECUTE 'SELECT RFRTH WITH CLIENT.NO = "':CLIENT.ID:'"'
      COUNTER=0
*
100   READNEXT OLD.ID ELSE STOP
      READ OLD.REC FROM F.RFRTH,OLD.ID ELSE GOTO 100
      COUNTER=COUNTER+1
      CRT COUNTER'R%5':' ':OLD.ID
*
      FOR I=1 TO X
        DET.ID=OLD.REC<3,I>
        DELETE F.RFRTD,DET.ID
      NEXT I
      DELETE F.RFRTH,OLD.ID
      GOTO 100
